import{m as k,a as m}from"./mixins-00a35343.js";import{m as $,a as B}from"./alertModal-064cb8ca.js";import{r as c,o as n,h as v,i as x,b as s,j as p,g as u,a as d,n as g,T as F,w as h,k as w,t as C,F as E,e as T,f as P,v as y}from"./index-a6b313c0.js";import{_ as O}from"./_plugin-vue_export-helper-c27b6911.js";import"./main-a60f64cc.js";const D={components:{modalconfirmacion:$,modalalerta:B},mixins:[k],data:()=>({profilePicChange:null,fotoMiniatura:null}),created(){},methods:{async deleteProfilePic(){await this.$refs.confirmation.show({title:"Eliminar Foto de Perfil",message:"¿Está seguro/a que desea eliminar su foto de perfil?",okButton:"Eliminar",cancelButton:"Volver"})&&m.post(`api/usuarios/deleteProfilePic/${this.userID}`).then(e=>{this.buttonDisable=!0,this.buttonText="Guardando...",this.toast.success("Foto de perfil eliminada con éxito!",{position:"top-right",timeout:5e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{location.reload()},1e3)}).catch(e=>{console.log(e),e.response.status==422&&(this.errors=e.response.data.errors,this.toast.warning("Error.",{position:"top-right",timeout:5e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}))})},async changeProfilePic(){if(await this.$refs.confirmation.show({title:"Actualizar Foto de Perfil",message:"¿Está seguro/a que desea actualizar su foto de perfil?",okButton:"Actualizar",cancelButton:"Volver"})){var e={userID:this.userID,profilePicChange:this.profilePicChange};m.post("api/usuarios/changeProfilePic",e,{headers:{"Content-Type":"multipart/form-data"}}).then(i=>{this.buttonDisable=!0,this.buttonText="Guardando...",this.toast.success("Foto de perfil actualizada con éxito!",{position:"top-right",timeout:5e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{location.reload()},1e3)}).catch(i=>{console.log(i),i.response.status==422&&(this.errors=i.response.data.errors,this.toast.warning("Existe un valor inválido.",{position:"top-right",timeout:5e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}))})}},async getImage(t){this.profilePicChange=t.target.files[0];let e=[];await this.compressImages(this.profilePicChange,e);var i=new File([e[0]],e[0].name,{type:e[0].type});this.profilePicChange=i,this.chargeImage(this.profilePicChange)},chargeImage(t){let e=new FileReader;e.onload=i=>{this.fotoMiniatura=i.target.result},e.readAsDataURL(t)}},computed:{imagen(){return this.fotoMiniatura}}},L={name:"modal"},R={class:"modal-mask"},j={class:"modal-wrapper"},z={class:"modal-container-xs"},U={class:"modal-header pb-2",style:{"font-weight":"bold",color:"#444444"}},I={class:"modal-body"},V={class:"row"},N={class:"col-12"},M={class:"form-group"},A={key:0,class:"col-auto"},S={class:"img-not-draggable",style:{position:"relative",left:"50%",top:"50%",transform:"translate(-50%, -50%)","-webkit-transform":"translate(-50%, -50%)"}},q={style:{width:"150px",height:"150px",display:"flex","justify-content":"center","align-items":"center"}},X=["src"],G={key:1,class:"col-auto"},J=s("div",{class:"img-not-draggable",style:{position:"relative",left:"50%",top:"50%",transform:"translate(-50%, -50%)","-webkit-transform":"translate(-50%, -50%)"}},[s("div",{style:{width:"150px",height:"150px",display:"flex","justify-content":"center","align-items":"center"}},[s("img",{class:"w-100 h-100 border-radius-100 shadow-sm",style:{"object-fit":"cover"},src:"https://icon-library.com/images/default-user-icon/default-user-icon-13.jpg",alt:"profile_image"})])],-1),K=[J],Q={class:"modal-footer"},W=["disabled"],Y=["disabled"];function Z(t,e,i,f,o,r){const b=c("modalconfirmacion"),_=c("modalalerta");return n(),v(F,{name:"modalcrear"},{default:x(()=>[s("div",L,[s("div",R,[s("div",j,[s("div",z,[s("div",U,[p(t.$slots,"header",{},()=>[u(" Profile pic ")]),s("a",{class:"btn btn-closed",onClick:e[0]||(e[0]=l=>t.$emit("close")),ref:"closeBtn"},"X",512)]),s("div",I,[p(t.$slots,"body",{},()=>[s("div",V,[s("div",N,[s("div",M,[s("input",{type:"file",accept:".jpg, .jpeg, .png, .heif, .heic, .pdf",id:"foto",class:"form-control",onChange:e[1]||(e[1]=(...l)=>r.getImage&&r.getImage(...l))},null,32)])]),t.fotoMiniatura!=null?(n(),d("div",A,[s("div",S,[s("div",q,[s("img",{class:"img-not-draggable w-100 h-100 border-radius-100 shadow-sm",style:{"object-fit":"cover"},src:r.imagen,alt:"profile_image"},null,8,X)])])])):(n(),d("div",G,K))])])]),s("div",Q,[p(t.$slots,"footer",{},()=>[s("button",{class:"btn btn-closed float-start",onClick:e[2]||(e[2]=l=>{r.deleteProfilePic()}),disabled:t.buttonDisable},"Delete",8,W),s("button",{class:"btn btn-alert float-end",onClick:e[3]||(e[3]=l=>r.changeProfilePic()),disabled:t.buttonDisable},"Save",8,Y)])]),g(b,{ref:"confirmation"},null,512),g(_,{ref:"alert"},null,512)])])])])]),_:3})}const ss=O(D,[["render",Z]]),es={components:{modalconfirmacion:$,modalalerta:B},mixins:[k],data:()=>({buttonText:"Save Changes",buttonDisable:!1,id:"",edits:{password:"",confirmPassword:""},errors:[]}),props:{password1:Object},created(){this.id=this.password1.id},methods:{cerrarModal(){this.$refs.closeBtn.click()},capitalizeFirstLetter(t){return t.charAt(0).toUpperCase()+t.slice(1)},async changePassword(){this.errors=[];for(const i in this.edits)(this.edits[i]===""||this.edits[i]===null)&&this.errors.push(i);this.edits.password!=this.edits.confirmPassword&&this.errors.push("diferents");var t="";if(this.errors.length!=0&&(this.errors.forEach(i=>{i=="confirmPassword"?t=t+`The field Confirm Password is required
`:i=="diferents"?t=t+`The passwords entered do not match
`:t=t+"The field "+this.capitalizeFirstLetter(i)+` is required
`}),this.toast.warning(t,{position:"top-right",timeout:5e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})),this.errors.length===0&&await this.$refs.confirmation.show({title:"Change Password",message:"Are you sure you want to change your password?.",okButton:"Save",cancelButton:"Return"})){let f={password:this.edits.password};var e=this.id;m.put(`api/changePassword/${e}`,f).then(o=>{this.buttonText="Editing...",this.buttonDisable=!0,this.toast.success("Profile edited successfully!",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.cerrarModal()},1500)}).catch(o=>{o.response.status==422&&(this.errors=o.response.data.errors,this.toast.warning("Existe un valor inválido.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}))})}}}},ts={name:"modal"},os={class:"modal-mask"},is={class:"modal-wrapper"},rs={class:"modal-container-xs"},as={class:"modal-header fw-bold",style:{color:"#444444"}},ls={class:"modal-body"},ns={class:"row"},ds={class:"col-md-6"},cs={class:"form-group"},us=s("label",{for:""},"New Password: ",-1),hs=s("br",null,null,-1),fs={class:"col-md-6"},ms={class:"form-group"},ps=s("label",{for:""}," Confirm New Password: ",-1),gs=s("br",null,null,-1),bs={class:"modal-footer"},_s=["disabled"];function vs(t,e,i,f,o,r){const b=c("modalconfirmacion"),_=c("modalalerta");return n(),v(F,{name:"modaleditar"},{default:x(()=>[s("div",ts,[s("div",os,[s("div",is,[s("div",rs,[s("div",as,[p(t.$slots,"header",{},()=>[u(" Change Password ")]),s("a",{class:"btn btn-closed",onClick:e[0]||(e[0]=l=>t.$emit("close")),ref:"closeBtn"},"X",512)]),s("div",ls,[p(t.$slots,"body",{},()=>[s("div",ns,[s("div",ds,[s("div",cs,[us,hs,h(s("input",{type:"password",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=l=>t.edits.password=l)},null,512),[[w,t.edits.password]])])]),s("div",fs,[s("div",ms,[ps,gs,h(s("input",{type:"password",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=l=>t.edits.confirmPassword=l)},null,512),[[w,t.edits.confirmPassword]])])])]),s("div",bs,[p(t.$slots,"footer",{},()=>[s("a",{class:"btn btn-continue float-end",onClick:e[3]||(e[3]=l=>r.changePassword()),disabled:t.buttonDisable},C(t.buttonText),9,_s)])])])])])]),g(b,{ref:"confirmation"},null,512),g(_,{ref:"alert"},null,512)])])]),_:3})}const ws=O(es,[["render",vs]]),Ps={components:{modalconfirmacion:$,modalalerta:B,modalfotoperfil:ss,modalEditPassword:ws},mixins:[k],data(){return{showFotoPerfil:!1,isEditing:!1,usuario:null,roles:null,permisos:null,editables:{name:null,email:null},showEditPassword:!1,passwordEdit:null,id:null,errors:[],showRoles:!1}},created(){this.getUsuarios(this.userID),this.getRolesUsuario(this.userID)},methods:{editPassword(t){this.passwordEdit=t,this.showEditPassword=!0},mostrarRoles(){this.showRoles==!1?this.showRoles=!0:this.showRoles=!1},getRolesUsuario(t){m.get(`api/roles/${t}`).then(e=>{this.roles=e.data}).catch(e=>console.log(e))},getUsuarios(t){m.get(`api/usuarios/${t}`).then(e=>{this.usuario=e.data,this.id=this.usuario.id,this.profilePic=this.usuario.profilePic,this.editables.name=this.usuario.name,this.editables.email=this.usuario.email}).catch(e=>console.log(e))},editarPerfil(){this.isEditing=!0},cancelarEdicion(){this.isEditing=!1,this.getUsuarios(this.userID)},capitalizeFirstLetter(t){return t.charAt(0).toUpperCase()+t.slice(1)},async guardarPerfil(){this.errors=[];for(const i in this.editables)(this.editables[i]===""||this.editables[i]===null)&&i!="sobreMi"&&this.errors.push(i);var t="";if(this.errors.length!=0&&(this.errors.forEach(i=>{t=t+"The field "+this.capitalizeFirstLetter(i)+` is required
`}),this.toast.warning(t,{position:"top-right",timeout:5e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})),this.errors.length===0&&await this.$refs.confirmation.show({title:"Edit profile",message:"Are you sure you want to edit your profile?.",okButton:"Edit",cancelButton:"Return"})){let f={name:this.editables.name,email:this.editables.email};var e=this.id;m.put(`api/usuarios/${e}`,f).then(o=>{this.buttonText="Editing...",this.buttonDisable=!0,o.data=="email existente"?(this.toast.warning("There is already a user with the Email entered",{position:"top-right",timeout:5e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),this.buttonDisable=!1,this.buttonText="Edit User"):(this.toast.success("Profile edited successfully!",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),this.isEditing=!1,setTimeout(()=>{location.reload()},1500))}).catch(o=>{o.response.status==422&&(this.errors=o.response.data.errors,this.toast.warning("There is an invalid value.",{position:"top-right",closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}))})}}}},ys={class:"card shadow-lg mx-4 card-profile-bottom"},Cs={class:"card-body p-3"},ks={class:"row gx-4"},$s=s("div",{class:"col-auto"},[s("div",{style:{position:"relative",left:"50%",top:"50%",transform:"translate(-50%, -50%)","-webkit-transform":"translate(-50%, -50%)"}},[s("div",{style:{width:"150px",height:"150px",display:"flex","justify-content":"center","align-items":"center"}},[s("img",{class:"img-not-draggable w-100 h-100 border-radius-100 shadow-sm",style:{"object-fit":"cover"},src:"https://icon-library.com/images/default-user-icon/default-user-icon-13.jpg"})])])],-1),Bs={class:"col-auto my-auto"},Os={class:"mb-1"},Es={class:"d-flex"},xs={class:"col-md-2 me-sm-0 mx-auto mt-3"},Fs={class:"form-group"},Hs=s("i",{class:"fa fa-fw fa-edit"},null,-1),Ts={key:0,class:"container-fluid py-3"},Ds={class:"row"},Ls={class:"col-md-12"},Rs={class:"card"},js={class:"card-header pb-0"},zs=s("div",{class:"d-flex align-items-center"},[s("h5",null,"Roles")],-1),Us={class:"card-body"},Is={key:0},Vs=s("div",{class:"fs-7"},"No roles.",-1),Ns=[Vs],Ms={key:1,class:"displayRolesPermisos"},As={class:"container-fluid py-3"},Ss={class:"row"},qs={class:"col-md-12"},Xs={class:"card"},Gs={class:"card-header pb-0"},Js=s("i",{class:"fa fa-fw fa-edit"},null,-1),Ks=s("div",{class:"d-flex align-items-center"},[s("h5",null,"Personal information")],-1),Qs=s("hr",{class:"horizontal dark"},null,-1),Ws={class:"card-body"},Ys={class:"row"},Zs={class:"col-md-6"},se={class:"form-group"},ee=s("label",{for:"example-text-input",class:"form-control-label"},"Name:",-1),te=s("br",null,null,-1),oe=["disabled"],ie={class:"col-md-6"},re={class:"form-group"},ae=s("label",{for:"example-text-input",class:"form-control-label"},"Email:",-1),le=s("br",null,null,-1),ne=["disabled"],de={class:"d-flex justify-content-end"},ce=s("i",{class:"fa-regular fa-floppy-disk fa-lg"},null,-1),ue=s("i",{class:"fa-solid fa-ban"},null,-1);function he(t,e,i,f,o,r){const b=c("modalfotoperfil"),_=c("modalconfirmacion"),l=c("modalEditPassword"),H=c("modalalerta");return n(),d(E,null,[s("div",ys,[s("div",Cs,[s("div",ks,[$s,s("div",Bs,[s("h5",Os,C(t.userName),1),s("div",Es,[s("a",{onClick:e[0]||(e[0]=a=>r.mostrarRoles()),class:"btn btn-dark"},"Roles")])]),s("div",xs,[s("div",Fs,[s("a",{onClick:e[1]||(e[1]=a=>r.editPassword(o.usuario)),class:"btn btn-alert",title:"Change Password",style:{float:"right","font-size":"16px"}},[Hs,u("Change Password")])])])])])]),o.showRoles?(n(),d("div",Ts,[s("div",Ds,[s("div",Ls,[s("div",Rs,[s("div",js,[s("a",{class:"btn btn-closed",style:{float:"right"},onClick:e[2]||(e[2]=a=>r.mostrarRoles())},"X"),zs]),s("div",Us,[t.isEmpty(o.roles)?(n(),d("div",Is,Ns)):(n(),d("div",Ms,[(n(!0),d(E,null,T(o.roles,a=>(n(),d("p",{key:a,class:"mb-0 font-weight-bold text-sm"},C(a.name)+"   ",1))),128))]))])])])])])):P("",!0),s("div",As,[s("div",Ss,[s("div",qs,[s("div",Xs,[s("div",Gs,[h(s("a",{onClick:e[3]||(e[3]=a=>r.editarPerfil()),class:"btn btn-alert",title:"Edit",style:{float:"right","font-size":"16px"}},[Js,u(" Edit")],512),[[y,!o.isEditing]]),Ks,Qs]),s("div",Ws,[s("div",Ys,[s("div",Zs,[s("div",se,[ee,te,h(s("input",{disabled:o.isEditing==!1,class:"form-control",type:"text","onUpdate:modelValue":e[4]||(e[4]=a=>o.editables.name=a)},null,8,oe),[[w,o.editables.name]])])]),s("div",ie,[s("div",re,[ae,le,h(s("input",{disabled:o.isEditing==!1,class:"form-control",type:"text","onUpdate:modelValue":e[5]||(e[5]=a=>o.editables.email=a)},null,8,ne),[[w,o.editables.email]])])])]),s("div",de,[h(s("a",{onClick:e[6]||(e[6]=a=>r.guardarPerfil()),class:"btn btn-continue",style:{"font-size":"16px"}},[ce,u(" Save")],512),[[y,o.isEditing]]),u("   "),h(s("a",{onClick:e[7]||(e[7]=a=>r.cancelarEdicion()),class:"btn btn-closed",style:{"font-size":"16px"}},[ue,u(" Cancel")],512),[[y,o.isEditing]])])])])]),o.showFotoPerfil?(n(),v(b,{key:0,onClose:e[8]||(e[8]=a=>o.showFotoPerfil=!1)})):P("",!0),g(_,{ref:"confirmation"},null,512),o.showEditPassword?(n(),v(l,{key:1,password1:o.passwordEdit,onClose:e[9]||(e[9]=a=>o.showEditPassword=!1)},null,8,["password1"])):P("",!0),g(H,{ref:"alert"},null,512)])])],64)}const _e=O(Ps,[["render",he]]);export{_e as default};
