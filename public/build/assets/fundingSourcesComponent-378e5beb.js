import{m as B,a as p}from"./mixins-00a35343.js";import{m as Y}from"./detailsFundingSourcesModal-1cbc9648.js";import{m as P,a as k}from"./alertModal-064cb8ca.js";import{m as I,s as V}from"./multiselect-040cdaf8.js";import{r as m,o as l,h as O,i as L,b as e,j as y,g as b,t as S,a as g,w as a,F,e as T,l as $,f as v,k as f,n as _,m as U,T as j,v as H,p as q}from"./index-a6b313c0.js";/* empty css                                                         */import{_ as D}from"./_plugin-vue_export-helper-c27b6911.js";import"./main-a60f64cc.js";const E={components:{modalProgressYear:I,Multiselect:V,modalconfirmacion:P,modalalerta:k},mixins:[B],data:()=>({fundingSource:{typeSources:"",nameOfInstitution:"",programContest:"",projectTitle:"",researcherInvolved:null,startDate:"",finishDate:"",comments:"",inCash:"",typeOfCollaboration:"",progressReport:""},draft:!1,showModalProgress:!1,researchers:"",buttonDisable:!1,usuarios:[],idResearcher:"",errors:[],buttonText:"Save source"}),mounted(){this.getUsuarios(),this.getUsuarios2(),this.getProgressReport()},methods:{handleFormSubmit1(s){this.fundingSource.progressReport=s},getProgressReport(){p.get("api/showProgressReport").then(s=>{this.fundingSource.progressReport=s.data}).catch(s=>console.log(s))},getUsuarios2(){p.get("api/usuarios").then(s=>{this.usuarios=s.data.sort((t,r)=>t.name.localeCompare(r.name))}).catch(s=>console.log(s))},getUsuarios(){p.get("api/researchers").then(s=>{this.researchers=s.data}).catch(s=>console.log(s))},async guardarBorrador(){if(await this.$refs.confirmation.show({title:"Save draft",message:"¿Are you sure you want to save this Funding source as a draft? this action cannot be undone.",okButton:"Save",cancelButton:"Return"})){var t="";this.fundingSource.researcherInvolved!==null&&this.fundingSource.researcherInvolved.length!==0&&this.fundingSource.researcherInvolved.forEach((n,i)=>{t+=n.name,i===this.fundingSource.researcherInvolved.length-1?t+=".":t+=", "});var r="";this.idResearcher!=""?r=this.idResearcher:r=this.userID;let h={idUsuario:r,status:"Draft",typeSources:this.fundingSource.typeSources,nameOfInstitution:this.fundingSource.nameOfInstitution,programContest:this.fundingSource.programContest,projectTitle:this.fundingSource.projectTitle,researcherInvolved:t,principalResearcher:this.fundingSource.principalResearcher,startDate:this.fundingSource.startDate,finishDate:this.fundingSource.finishDate,startYear:this.fundingSource.startYear,endingYear:this.fundingSource.endingYear,comments:this.fundingSource.comments,inCash:this.fundingSource.inCash,typeOfCollaboration:this.fundingSource.typeOfCollaboration,progressReport:this.fundingSource.progressReport};p.post("api/fundingSources",h).then(n=>{this.toast.success("Draft saved successfully!",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.cerrarModal()},1500)}).catch(n=>{n.response?n.response.status===422?this.toast.warning(`Validation error: ${n.response.data.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):n.response.status===404?this.toast.error("Resource not found.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):this.toast.error(`An error occurred: ${n.response.data.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):n.request?this.toast.error("No response from server.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):this.toast.error(`An error occurred: ${n.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})})}},cerrarModal(){const s=this.$refs.closeBtn;this.$emit("recarga"),s.click()},capitalizeFirstLetter(s){return s.charAt(0).toUpperCase()+s.slice(1)},async createFunding(){this.errors=[];for(const n in this.fundingSource)n!=="comments"&&(this.fundingSource[n]===""||this.fundingSource[n]===0||this.fundingSource[n]==null||this.fundingSource[n]==[])&&this.errors.push(n);var s=await p.post("../api/verifyFunding",this.fundingSource).then((function(n){return n.data}).bind(this)).catch(function(n){console.log(n)});s>0&&this.errors.push("duplicated");var t="";if(this.errors.length!=0&&(this.errors.forEach(n=>{n=="typeSources"?t=t+`The field Type of sources is required
`:n=="nameOfInstitution"?t=t+`The field Name of institution is required
`:n=="programContest"?t=t+`The field Program contest is required
`:n=="projectTitle"?t=t+`The field Project title is required
`:n=="researcherInvolved"?t=t+`The field Principal researcher is required
`:n=="startDate"?t=t+`The field Start date is required
`:n=="finishDate"?t=t+`The field Finish date is required
`:n=="inCash"?t=t+`The field In cash is required
`:n=="typeOfCollaboration"?t=t+`The field Type of collaboration is required
`:n=="duplicated"?t=t+`There is already a post with the same data, please try again.
`:t=t+"The field "+this.capitalizeFirstLetter(n)+` is required
`}),this.toast.warning(t,{position:"top-right",timeout:5e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})),this.errors.length===0&&await this.$refs.confirmation.show({title:"Save Funding source",message:"¿Are you sure you want to save this Funding source?.",okButton:"Save",cancelButton:"Return"})){var r="";this.fundingSource.researcherInvolved!==null&&this.fundingSource.researcherInvolved.length!==0&&this.fundingSource.researcherInvolved.forEach((u,d)=>{r+=u.name,d===this.fundingSource.researcherInvolved.length-1?r+=".":r+=", "});var h="";this.idResearcher!=""?h=this.idResearcher:h=this.userID;let i={status:"Finished",idUsuario:h,typeSources:this.fundingSource.typeSources,nameOfInstitution:this.fundingSource.nameOfInstitution,programContest:this.fundingSource.programContest,projectTitle:this.fundingSource.projectTitle,researcherInvolved:r,principalResearcher:this.fundingSource.principalResearcher,startDate:this.fundingSource.startDate,finishDate:this.fundingSource.finishDate,startYear:this.fundingSource.startYear,endingYear:this.fundingSource.endingYear,comments:this.fundingSource.comments,inCash:this.fundingSource.inCash,typeOfCollaboration:this.fundingSource.typeOfCollaboration,progressReport:this.fundingSource.progressReport};p.post("api/fundingSources",i).then(u=>{this.toast.success("Funding source saved successfully!",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.cerrarModal()},1500)}).catch(u=>{u.response?u.response.status===422?this.toast.warning(`Validation error: ${u.response.data.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):u.response.status===404?this.toast.error("Resource not found.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):this.toast.error(`An error occurred: ${u.response.data.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):u.request?this.toast.error("No response from server.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):this.toast.error(`An error occurred: ${u.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})})}}}},M={name:"modal"},A={class:"modal-mask"},N={class:"modal-wrapper"},G={class:"modal-container"},z={class:"modal-header pb-1 fw-bold",style:{color:"#444444"}},X={for:""},W=e("i",{class:"fa-solid fa-pen-to-square"},null,-1),J=[W],K={key:0,class:"col-5 m-0"},Q={class:"fw-normal",style:{"font-size":"14px"}},Z=e("option",{disabled:"",value:""},"Select a researcher",-1),x=["value"],ee={class:"modal-body"},te={class:"row"},se={class:"col-md-3"},oe=e("label",{for:""},"Type of sources: ",-1),ne=e("br",null,null,-1),re=e("option",{disabled:"",value:""},"Select a type",-1),ie=e("option",{value:"Public funds"},"Public funds",-1),ae=e("option",{value:"Productive/Private funds"},"Productive/Private funds",-1),le=e("option",{value:"International funds"},"International funds",-1),ue=[re,ie,ae,le],de={class:"col-md-3"},ce=e("label",{for:""},"Name of institution:",-1),he=e("br",null,null,-1),fe={class:"col-md-3"},ge=e("label",{for:""},"Program/contest:",-1),pe=e("br",null,null,-1),me={class:"col-md-3"},be=e("label",{for:""},"Project title:",-1),Se=e("br",null,null,-1),ve=e("br",null,null,-1),_e={class:"row"},Ce={class:"col-md-6"},Oe=e("label",{for:""},"AC3E researcher involved:",-1),ye={class:"col-md-3"},$e=e("label",{for:""},"Start date:",-1),we=e("br",null,null,-1),Be={class:"col-md-3"},Pe=e("label",{for:""},"Finish date:",-1),ke=e("br",null,null,-1),Fe=e("br",null,null,-1),Te={class:"row"},De={class:"col-md-6"},Re=e("label",{for:""},"Principal researcher:",-1),He=e("br",null,null,-1),Ie={class:"col-md-3"},Ve=e("label",{for:""},"In cash:",-1),Le=e("br",null,null,-1),Ue={class:"col-md-3"},je=e("label",{for:""},"Type of collaboration: ",-1),Ye=e("br",null,null,-1),qe=e("option",{disabled:"",value:""},"Select a type",-1),Ee=e("option",{value:"Technical assitance"},"Technical assitance",-1),Me=e("option",{value:"Patents"},"Patents",-1),Ae=e("option",{value:"License"},"License",-1),Ne=e("option",{value:"Grand/Competitive fund"},"Grand/Competitive fund",-1),Ge=e("option",{value:"Other (Specify in comments)"},"Other (Specify in comments)",-1),ze=[qe,Ee,Me,Ae,Ne,Ge],Xe=e("br",null,null,-1),We={class:"row"},Je={class:"col-md-6"},Ke=e("label",{for:""},"Comments:",-1),Qe=e("br",null,null,-1),Ze={class:"modal-footer"},xe={class:"form-check-label"},et=["disabled"],tt=["disabled"];function st(s,t,r,h,n,i){const u=m("Multiselect"),d=m("modalconfirmacion"),C=m("modalalerta"),w=m("modalProgressYear");return l(),O(j,{name:"modalcrear"},{default:L(()=>[e("div",M,[e("div",A,[e("div",N,[e("div",G,[e("div",z,[y(s.$slots,"header",{},()=>[b(" New Funding source ")]),e("label",X,[b("Progress year: "+S(s.fundingSource.progressReport)+"    ",1),e("a",{class:"btn",onClick:t[0]||(t[0]=o=>s.showModalProgress=!0)},J)]),s.is("Administrator")?(l(),g("label",K,[b(" Researcher: "),e("label",Q,[a(e("select",{class:"form-select","onUpdate:modelValue":t[1]||(t[1]=o=>s.idResearcher=o)},[Z,(l(!0),g(F,null,T(s.usuarios,o=>(l(),g("option",{key:o.id,value:o.id},S(o.name),9,x))),128))],512),[[$,s.idResearcher]])])])):v("",!0),e("a",{class:"btn btn-closed",onClick:t[2]||(t[2]=o=>s.$emit("close")),ref:"closeBtn"},"X",512)]),e("div",ee,[y(s.$slots,"body",{},()=>[e("div",te,[e("div",se,[oe,ne,a(e("select",{class:"form-select","onUpdate:modelValue":t[3]||(t[3]=o=>s.fundingSource.typeSources=o)},ue,512),[[$,s.fundingSource.typeSources]])]),e("div",de,[ce,he,a(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=o=>s.fundingSource.nameOfInstitution=o)},null,512),[[f,s.fundingSource.nameOfInstitution]])]),e("div",fe,[ge,pe,a(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=o=>s.fundingSource.programContest=o)},null,512),[[f,s.fundingSource.programContest]])]),e("div",me,[be,Se,a(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[6]||(t[6]=o=>s.fundingSource.projectTitle=o)},null,512),[[f,s.fundingSource.projectTitle]])])]),ve,e("div",_e,[e("div",Ce,[Oe,_(u,{placeholder:"Select the participants",modelValue:s.fundingSource.researcherInvolved,"onUpdate:modelValue":t[7]||(t[7]=o=>s.fundingSource.researcherInvolved=o),searchable:!0,"close-on-select":!1,createTag:!0,options:s.researchers,mode:"tags",label:"name",trackBy:"name",object:!0},null,8,["modelValue","options"])]),e("div",ye,[$e,we,a(e("input",{type:"date",class:"form-control","onUpdate:modelValue":t[8]||(t[8]=o=>s.fundingSource.startDate=o)},null,512),[[f,s.fundingSource.startDate]])]),e("div",Be,[Pe,ke,a(e("input",{type:"date",class:"form-control","onUpdate:modelValue":t[9]||(t[9]=o=>s.fundingSource.finishDate=o)},null,512),[[f,s.fundingSource.finishDate]])])]),Fe,e("div",Te,[e("div",De,[Re,He,a(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[10]||(t[10]=o=>s.fundingSource.principalResearcher=o)},null,512),[[f,s.fundingSource.principalResearcher]])]),e("div",Ie,[Ve,Le,a(e("input",{type:"number",class:"form-control","onUpdate:modelValue":t[11]||(t[11]=o=>s.fundingSource.inCash=o)},null,512),[[f,s.fundingSource.inCash]])]),e("div",Ue,[je,Ye,a(e("select",{class:"form-select","onUpdate:modelValue":t[12]||(t[12]=o=>s.fundingSource.typeOfCollaboration=o)},ze,512),[[$,s.fundingSource.typeOfCollaboration]])])]),Xe,e("div",We,[e("div",Je,[Ke,Qe,a(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[13]||(t[13]=o=>s.fundingSource.comments=o)},null,512),[[f,s.fundingSource.comments]])])])])]),e("div",Ze,[y(s.$slots,"footer",{},()=>[e("label",xe,[a(e("input",{type:"checkbox",class:"form-check-","onUpdate:modelValue":t[14]||(t[14]=o=>s.draft=o)},null,512),[[U,s.draft]]),b(" Save as a draft")]),s.draft==!1?(l(),g("a",{key:0,class:"btn btn-continue float-end",onClick:t[15]||(t[15]=o=>i.createFunding()),disabled:s.buttonDisable},S(s.buttonText),9,et)):(l(),g("a",{key:1,class:"btn btn-continue float-end",onClick:t[16]||(t[16]=o=>i.guardarBorrador()),disabled:s.buttonDisable}," Save draft ",8,tt))])]),_(d,{ref:"confirmation"},null,512),_(C,{ref:"alert"},null,512),s.showModalProgress?(l(),O(w,{key:0,progressYear:s.fundingSource.progressReport,onClose:t[17]||(t[17]=o=>s.showModalProgress=!1),onSubmit:i.handleFormSubmit1},null,8,["progressYear","onSubmit"])):v("",!0)])])])])]),_:3})}const ot=D(E,[["render",st]]),nt={components:{modalProgressYear:I,Multiselect:V,modalconfirmacion:P,modalalerta:k},mixins:[B],data:()=>({fundingSource:{typeSources:"",nameOfInstitution:"",programContest:"",projectTitle:"",researcherInvolved:null,startDate:"",finishDate:"",comments:"",inCash:"",typeOfCollaboration:"",progressReport:""},draft:!1,showModalProgress:!1,researchers:"",usuarios:[],idResearcher:"",id:"",buttonDisable:!1,errors:[],buttonText:"Edit source"}),mounted(){this.getUsuarios(),this.getUsuarios2()},props:{fundingSource1:Object},created(){if(this.id=this.fundingSource1.id,this.idResearcher=this.fundingSource1.idUsuario,this.fundingSource.typeSources=this.fundingSource1.typeSources,this.fundingSource.nameOfInstitution=this.fundingSource1.nameOfInstitution,this.fundingSource.programContest=this.fundingSource1.programContest,this.fundingSource.projectTitle=this.fundingSource1.projectTitle,this.fundingSource.startDate=this.fundingSource1.startDate,this.fundingSource.finishDate=this.fundingSource1.finishDate,this.fundingSource.comments=this.fundingSource1.comments,this.fundingSource.inCash=this.fundingSource1.inCash,this.fundingSource.typeOfCollaboration=this.fundingSource1.typeOfCollaboration,this.fundingSource.progressReport=this.fundingSource1.progressReport,this.fundingSource.principalResearcher=this.fundingSource1.principalResearcher,this.fundingSource1.researcherInvolved!=null){const s=this.fundingSource1.researcherInvolved.split(",");this.fundingSource.researcherInvolved=s.map((t,r)=>(t=t.trim(),t.endsWith(".")&&(t=t.slice(0,-1)),{value:t,name:t}))}},methods:{getUsuarios2(){p.get("api/usuarios").then(s=>{this.usuarios=s.data.sort((t,r)=>t.name.localeCompare(r.name))}).catch(s=>console.log(s))},handleFormSubmit1(s){this.fundingSource.progressReport=s},getUsuarios(){p.get("api/researchers").then(s=>{this.researchers=s.data}).catch(s=>console.log(s))},async guardarBorrador(){if(await this.$refs.confirmation.show({title:"Edit draft",message:"¿Are you sure you want to edit this Funding source as a draft? this action cannot be undone.",okButton:"Edit",cancelButton:"Return"})){var t="";this.fundingSource.researcherInvolved!==null&&this.fundingSource.researcherInvolved.length!==0&&this.fundingSource.researcherInvolved.forEach((n,i)=>{t+=n.name,i===this.fundingSource.researcherInvolved.length-1?t+=".":t+=", "});var r="";this.idResearcher!=""?r=this.idResearcher:r=this.userID;let h={idUsuario:r,status:"Draft",typeSources:this.fundingSource.typeSources,nameOfInstitution:this.fundingSource.nameOfInstitution,programContest:this.fundingSource.programContest,projectTitle:this.fundingSource.projectTitle,researcherInvolved:t,principalResearcher:this.fundingSource.principalResearcher,startDate:this.fundingSource.startDate,finishDate:this.fundingSource.finishDate,startYear:this.fundingSource.startYear,endingYear:this.fundingSource.endingYear,comments:this.fundingSource.comments,inCash:this.fundingSource.inCash,typeOfCollaboration:this.fundingSource.typeOfCollaboration,progressReport:this.fundingSource.progressReport};p.put(`api/fundingSources/${this.id}`,h).then(n=>{this.toast.success("Draft saved successfully!",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.cerrarModal()},1500)}).catch(n=>{n.response?n.response.status===422?this.toast.warning(`Validation error: ${n.response.data.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):n.response.status===404?this.toast.error("Resource not found.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):this.toast.error(`An error occurred: ${n.response.data.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):n.request?this.toast.error("No response from server.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):this.toast.error(`An error occurred: ${n.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})})}},cerrarModal(){const s=this.$refs.closeBtn;this.$emit("recarga"),s.click()},capitalizeFirstLetter(s){return s.charAt(0).toUpperCase()+s.slice(1)},async editFunding(){this.errors=[];for(const i in this.fundingSource)(this.fundingSource[i]===""||this.fundingSource[i]===0||this.fundingSource[i]==null||this.fundingSource[i]==[])&&this.errors.push(i);let s={id:this.id,typeSources:this.fundingSource.typeSources,nameOfInstitution:this.fundingSource.nameOfInstitution,programContest:this.fundingSource.programContest,projectTitle:this.fundingSource.projectTitle,researcherInvolved:h,principalResearcher:this.fundingSource.principalResearcher,startDate:this.fundingSource.startDate,finishDate:this.fundingSource.finishDate,startYear:this.fundingSource.startYear,endingYear:this.fundingSource.endingYear,comments:this.fundingSource.comments,inCash:this.fundingSource.inCash,typeOfCollaboration:this.fundingSource.typeOfCollaboration,progressReport:this.fundingSource.progressReport};var t=await p.post("../api/verifyFunding",s).then((function(i){return i.data}).bind(this)).catch(function(i){console.log(i)});t>0&&this.errors.push("duplicated");var r="";if(this.errors.length!=0&&(this.errors.forEach(i=>{i=="typeSources"?r=r+`The field Type of sources is required
`:i=="nameOfInstitution"?r=r+`The field Name of institution is required
`:i=="programContest"?r=r+`The field Program contest is required
`:i=="projectTitle"?r=r+`The field Project title is required
`:i=="researcherInvolved"?r=r+`The field Principal researcher is required
`:i=="startDate"?r=r+`The field Start date is required
`:i=="finishDate"?r=r+`The field Finish date is required
`:i=="inCash"?r=r+`The field In cash is required
`:i=="typeOfCollaboration"?r=r+`The field Type of collaboration is required
`:i=="duplicated"?r=r+`There is already a post with the same data, please try again.
`:r=r+"The field "+this.capitalizeFirstLetter(i)+` is required
`}),this.toast.warning(r,{position:"top-right",timeout:5e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})),this.errors.length===0&&await this.$refs.confirmation.show({title:"Edit Funding source",message:"¿Are you sure you want to edit this Funding source?.",okButton:"Edit",cancelButton:"Return"})){var h="";this.fundingSource.researcherInvolved!==null&&this.fundingSource.researcherInvolved.length!==0&&this.fundingSource.researcherInvolved.forEach((d,C)=>{h+=d.name,C===this.fundingSource.researcherInvolved.length-1?h+=".":h+=", "});var n="";this.idResearcher!=""?n=this.idResearcher:n=this.userID;let u={idUsuario:n,status:"Finished",typeSources:this.fundingSource.typeSources,nameOfInstitution:this.fundingSource.nameOfInstitution,programContest:this.fundingSource.programContest,projectTitle:this.fundingSource.projectTitle,researcherInvolved:h,startDate:this.fundingSource.startDate,finishDate:this.fundingSource.finishDate,startYear:this.fundingSource.startYear,endingYear:this.fundingSource.endingYear,comments:this.fundingSource.comments,inCash:this.fundingSource.inCash,typeOfCollaboration:this.fundingSource.typeOfCollaboration,progressReport:this.fundingSource.progressReport};p.put(`api/fundingSources/${this.id}`,u).then(d=>{this.toast.success("Funding source edited successfully!",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.cerrarModal()},1500)}).catch(d=>{d.response?d.response.status===422?this.toast.warning(`Validation error: ${d.response.data.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):d.response.status===404?this.toast.error("Resource not found.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):this.toast.error(`An error occurred: ${d.response.data.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):d.request?this.toast.error("No response from server.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):this.toast.error(`An error occurred: ${d.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})})}}}},rt={name:"modal"},it={class:"modal-mask"},at={class:"modal-wrapper"},lt={class:"modal-container"},ut={class:"modal-header pb-1 fw-bold",style:{color:"#444444"}},dt={for:""},ct=e("i",{class:"fa-solid fa-pen-to-square"},null,-1),ht=[ct],ft={key:0,class:"col-5 m-0"},gt={class:"fw-normal",style:{"font-size":"14px"}},pt=e("option",{disabled:"",value:""},"Select a researcher",-1),mt=["value"],bt={class:"modal-body"},St={class:"row"},vt={class:"col-md-3"},_t=e("label",{for:""},"Type of sources: ",-1),Ct=e("br",null,null,-1),Ot=e("option",{disabled:"",value:null},"Select a type",-1),yt=e("option",{value:"Public funds"},"Public funds",-1),$t=e("option",{value:"Productive/Private funds"},"Productive/Private funds",-1),wt=e("option",{value:"International funds"},"International funds",-1),Bt=[Ot,yt,$t,wt],Pt={class:"col-md-3"},kt=e("label",{for:""},"Name of institution:",-1),Ft=e("br",null,null,-1),Tt={class:"col-md-3"},Dt=e("label",{for:""},"Program/contest:",-1),Rt=e("br",null,null,-1),Ht={class:"col-md-3"},It=e("label",{for:""},"Project title:",-1),Vt=e("br",null,null,-1),Lt=e("br",null,null,-1),Ut={class:"row"},jt={class:"col-md-6"},Yt=e("label",{for:""},"AC3E researcher involved:",-1),qt={class:"col-md-3"},Et=e("label",{for:""},"Start date:",-1),Mt=e("br",null,null,-1),At={class:"col-md-3"},Nt=e("label",{for:""},"Finish date:",-1),Gt=e("br",null,null,-1),zt=e("br",null,null,-1),Xt={class:"row"},Wt={class:"col-md-6"},Jt=e("label",{for:""},"Principal researcher:",-1),Kt=e("br",null,null,-1),Qt={class:"col-md-3"},Zt=e("label",{for:""},"In cash:",-1),xt=e("br",null,null,-1),es={class:"col-md-3"},ts=e("label",{for:""},"Type of collaboration: ",-1),ss=e("br",null,null,-1),os=e("option",{disabled:"",value:null},"Select a type",-1),ns=e("option",{value:"Technical assitance"},"Technical assitance",-1),rs=e("option",{value:"Patents"},"Patents",-1),is=e("option",{value:"License"},"License",-1),as=e("option",{value:"Grand/Competitive fund"},"Grand/Competitive fund",-1),ls=e("option",{value:"Other (Specify in comments)"},"Other (Specify in comments)",-1),us=[os,ns,rs,is,as,ls],ds=e("br",null,null,-1),cs={class:"row"},hs={class:"col-md-6"},fs=e("label",{for:""},"Comments:",-1),gs=e("br",null,null,-1),ps={class:"modal-footer"},ms={class:"form-check-label"},bs=["disabled"],Ss=["disabled"];function vs(s,t,r,h,n,i){const u=m("Multiselect"),d=m("modalconfirmacion"),C=m("modalalerta"),w=m("modalProgressYear");return l(),O(j,{name:"modalcrear"},{default:L(()=>[e("div",rt,[e("div",it,[e("div",at,[e("div",lt,[e("div",ut,[y(s.$slots,"header",{},()=>[b(" Edit Funding source ")]),e("label",dt,[b("Progress year: "+S(s.fundingSource.progressReport)+"    ",1),e("a",{class:"btn",onClick:t[0]||(t[0]=o=>s.showModalProgress=!0)},ht)]),s.is("Administrator")?(l(),g("label",ft,[b(" Researcher: "),e("label",gt,[a(e("select",{class:"form-select","onUpdate:modelValue":t[1]||(t[1]=o=>s.idResearcher=o)},[pt,(l(!0),g(F,null,T(s.usuarios,o=>(l(),g("option",{key:o.id,value:o.id},S(o.name),9,mt))),128))],512),[[$,s.idResearcher]])])])):v("",!0),e("a",{class:"btn btn-closed",onClick:t[2]||(t[2]=o=>s.$emit("close")),ref:"closeBtn"},"X",512)]),e("div",bt,[y(s.$slots,"body",{},()=>[e("div",St,[e("div",vt,[_t,Ct,a(e("select",{class:"form-select","onUpdate:modelValue":t[3]||(t[3]=o=>s.fundingSource.typeSources=o)},Bt,512),[[$,s.fundingSource.typeSources]])]),e("div",Pt,[kt,Ft,a(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=o=>s.fundingSource.nameOfInstitution=o)},null,512),[[f,s.fundingSource.nameOfInstitution]])]),e("div",Tt,[Dt,Rt,a(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=o=>s.fundingSource.programContest=o)},null,512),[[f,s.fundingSource.programContest]])]),e("div",Ht,[It,Vt,a(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[6]||(t[6]=o=>s.fundingSource.projectTitle=o)},null,512),[[f,s.fundingSource.projectTitle]])])]),Lt,e("div",Ut,[e("div",jt,[Yt,_(u,{placeholder:"Select the participants",modelValue:s.fundingSource.researcherInvolved,"onUpdate:modelValue":t[7]||(t[7]=o=>s.fundingSource.researcherInvolved=o),searchable:!0,"close-on-select":!1,createTag:!0,options:s.researchers,mode:"tags",label:"name",trackBy:"name",object:!0},null,8,["modelValue","options"])]),e("div",qt,[Et,Mt,a(e("input",{type:"date",class:"form-control","onUpdate:modelValue":t[8]||(t[8]=o=>s.fundingSource.startDate=o)},null,512),[[f,s.fundingSource.startDate]])]),e("div",At,[Nt,Gt,a(e("input",{type:"date",class:"form-control","onUpdate:modelValue":t[9]||(t[9]=o=>s.fundingSource.finishDate=o)},null,512),[[f,s.fundingSource.finishDate]])])]),zt,e("div",Xt,[e("div",Wt,[Jt,Kt,a(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[10]||(t[10]=o=>s.fundingSource.principalResearcher=o)},null,512),[[f,s.fundingSource.principalResearcher]])]),e("div",Qt,[Zt,xt,a(e("input",{type:"number",class:"form-control","onUpdate:modelValue":t[11]||(t[11]=o=>s.fundingSource.inCash=o)},null,512),[[f,s.fundingSource.inCash]])]),e("div",es,[ts,ss,a(e("select",{class:"form-select","onUpdate:modelValue":t[12]||(t[12]=o=>s.fundingSource.typeOfCollaboration=o)},us,512),[[$,s.fundingSource.typeOfCollaboration]])])]),ds,e("div",cs,[e("div",hs,[fs,gs,a(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[13]||(t[13]=o=>s.fundingSource.comments=o)},null,512),[[f,s.fundingSource.comments]])])])])]),e("div",ps,[y(s.$slots,"footer",{},()=>[e("label",ms,[a(e("input",{type:"checkbox",class:"form-check-","onUpdate:modelValue":t[14]||(t[14]=o=>s.draft=o)},null,512),[[U,s.draft]]),b(" Edit as a draft")]),s.draft==!1?(l(),g("a",{key:0,class:"btn btn-continue float-end",onClick:t[15]||(t[15]=o=>i.editFunding()),disabled:s.buttonDisable},S(s.buttonText),9,bs)):(l(),g("a",{key:1,class:"btn btn-continue float-end",onClick:t[16]||(t[16]=o=>i.guardarBorrador()),disabled:s.buttonDisable}," Edit draft ",8,Ss))])]),_(d,{ref:"confirmation"},null,512),_(C,{ref:"alert"},null,512),s.showModalProgress?(l(),O(w,{key:0,progressYear:s.fundingSource.progressReport,onClose:t[17]||(t[17]=o=>s.showModalProgress=!1),onSubmit:i.handleFormSubmit1},null,8,["progressYear","onSubmit"])):v("",!0)])])])])]),_:3})}const _s=D(nt,[["render",vs]]),Cs={components:{modalver:Y,modalcrear:ot,modaleditar:_s,modalconfirmacion:P,modalalerta:k},mixins:[B],data(){return{fundingSources:null,fundingSource:null,showDetailsSource:!1,showNewFundingSource:!1,showFundingSourceEdit:!1,fundingSourceEdit:null,mostrarTabla:!1,mostrarCarga:!0,table:null}},created(){this.getFundingSources(this.userID)},methods:{verFunding(s){this.fundingSource=s,this.showDetailsSource=!0},getFundingSources(s){p.get(`api/fundingSources/${s}`).then(t=>{this.fundingSources=t.data,this.table!=null&&(this.table.clear(),this.table.destroy()),this.crearTabla("#myTableFunding")}).catch(t=>console.log(t))},recargarTabla(s){this.mostrarCarga=!0,s=="General"?(this.fundingSources=null,this.getFundingSources(this.userID)):this.crearTabla("#myTableFunding")},editFundingSource(s){this.fundingSourceEdit=s,this.showFundingSourceEdit=!0},async deleteFundingSource(s){await this.$refs.confirmation.show({title:"Delete Funding source",message:"¿Are you sure you want to delete this Funding source?.",okButton:"Delete",cancelButton:"Return"})&&p.delete(`api/fundingSources/${s}`).then(r=>{this.toast.success("Funding source successfully removed!",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),this.recargarTabla("General")}).catch(r=>console.log(r))}}},Os={class:"row mt-4 mx-4"},ys={class:"col-12"},$s={class:"card mb-4"},ws={class:"row pb-0 p-4"},Bs={class:"col-12"},Ps={class:"d-flex justify-content-end"},ks=e("i",{class:"fa-solid fa-rotate"},null,-1),Fs=[ks],Ts={class:"card-body px-0 pt-0 pb-2",style:{"min-height":"400px"}},Ds={class:"container"},Rs={class:"table-responsive p-0"},Hs={class:"loader-sm"},Is={class:"table align-items-center mb-0",id:"myTableFunding"},Vs=e("thead",null,[e("tr",{style:{color:"black"}},[e("th",{style:{"min-width":"16px"}}),e("th",{class:"text-uppercase text-xs font-weight-bolder"},"ID"),e("th",{class:"text-uppercase text-xs font-weight-bolder"},"Actions"),e("th",{class:"text-uppercase text-xs font-weight-bolder"},"Status"),e("th",{class:"text-uppercase text-xs font-weight-bolder"},"User")])],-1),Ls=e("td",null,null,-1),Us={class:"text-sm font-weight-bolder mb-0",style:{color:"black"}},js={class:"align-middle text-end"},Ys={class:"d-flex px-3 py-1 justify-content-center align-items-center"},qs=["onClick"],Es=e("i",{class:"fa fa-fw fa-edit"},null,-1),Ms=[Es],As=["onClick"],Ns=e("i",{class:"fa-regular fa-eye"},null,-1),Gs=[Ns],zs=["onClick"],Xs=e("i",{class:"fa fa-fw fa-trash"},null,-1),Ws=[Xs],Js={key:0,class:"text-sm font-weight-bolder mb-0",style:{color:"#878686"}},Ks={key:1,class:"text-sm font-weight-bolder mb-0",style:{color:"#28A745"}},Qs={class:"text-sm mb-0"},Zs=q('<div class="row"><div class="col-3"><label style="font-weight:500;"> These buttons use the elements selected in the table, if none exist, it will select all the records. </label></div><div class="col-auto"><label title="To select a single record from the table, just do \r Click on the box in the first column to select \r several consecutive hold SHIFT, to select several \r non-consecutive hold CTRL."><span class="badge bg-dark-grey fs-10">?</span></label></div></div>',1);function xs(s,t,r,h,n,i){const u=m("modalconfirmacion"),d=m("modalalerta"),C=m("modalver"),w=m("modaleditar"),o=m("modalcrear");return l(),g("div",Os,[e("div",ys,[e("div",$s,[e("div",ws,[e("div",Bs,[e("div",Ps,[e("a",{class:"btn btn-spacing btn-continue",id:"show-modal1",onClick:t[0]||(t[0]=c=>n.showNewFundingSource=!0)},"New Source"),b("   "),e("a",{class:"btn btn-spacing btn-search-blue",onClick:t[1]||(t[1]=c=>i.recargarTabla("General"))},Fs)])])]),e("div",Ts,[e("div",Ds,[e("div",Rs,[a(e("div",Hs,null,512),[[H,n.mostrarCarga]]),a(e("table",Is,[Vs,e("tbody",null,[(l(!0),g(F,null,T(n.fundingSources,c=>(l(),g("tr",{key:c.id},[Ls,e("td",null,[e("p",Us,S(c.id),1)]),e("td",js,[e("div",Ys,[e("a",{class:"btn btn-alert btn-xs",title:"Edit",onClick:R=>i.editFundingSource(c)},Ms,8,qs),b("   "),e("a",{class:"btn btn-success btn-xs",title:"Details",onClick:R=>i.verFunding(c)},Gs,8,As),b("   "),e("a",{class:"btn btn-closed btn-xs",title:"Delete",onClick:R=>i.deleteFundingSource(c.id)},Ws,8,zs)])]),e("td",null,[c.status=="Draft"?(l(),g("p",Js,S(c.status),1)):v("",!0),c.status=="Finished"?(l(),g("p",Ks,S(c.status),1)):v("",!0)]),e("td",null,[e("p",Qs,S(c.usuario.name),1)])]))),128))])],512),[[H,n.mostrarTabla]]),Zs])])])]),_(u,{ref:"confirmation"},null,512),_(d,{ref:"alert"},null,512),n.showDetailsSource?(l(),O(C,{key:0,fundingSource1:n.fundingSource,onClose:t[2]||(t[2]=c=>n.showDetailsSource=!1)},null,8,["fundingSource1"])):v("",!0),n.showFundingSourceEdit?(l(),O(w,{key:1,fundingSource1:n.fundingSourceEdit,onClose:t[3]||(t[3]=c=>n.showFundingSourceEdit=!1),onRecarga:t[4]||(t[4]=c=>i.recargarTabla("General"))},null,8,["fundingSource1"])):v("",!0),n.showNewFundingSource?(l(),O(o,{key:2,onClose:t[5]||(t[5]=c=>n.showNewFundingSource=!1),onRecarga:t[6]||(t[6]=c=>i.recargarTabla("General"))})):v("",!0)])])}const lo=D(Cs,[["render",xs]]);export{lo as default};
