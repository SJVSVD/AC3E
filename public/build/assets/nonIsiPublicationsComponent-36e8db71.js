import{m as T,a as m}from"./mixins-00a35343.js";import{m as M}from"./detailsNonIsiPublicationModal-cc69e8a1.js";import{m as F,a as H}from"./alertModal-064cb8ca.js";import{m as S,s as V}from"./multiselect-040cdaf8.js";import{r as P,o as c,h as $,i as L,b as e,j as B,g as v,t as g,a as h,w as f,F as k,e as C,l as O,f as I,n as y,k as _,m as D,T as A,v as R,p as j}from"./index-a6b313c0.js";/* empty css                                                         */import{_ as N}from"./_plugin-vue_export-helper-c27b6911.js";import"./main-a60f64cc.js";const E={components:{modalProgressYear:S,Multiselect:V,modalconfirmacion:F,modalalerta:H},mixins:[T],data:()=>({nonIsiPublication:{authors:"",articleTitle:"",indexedBy:null,journalName:"",volume:"",firstPage:"",lastPage:"",yearPublished:"",month:"",fundings:null,file:"",researcherInvolved:null,comments:"",progressReport:""},options1:["Basal Financing Program Funding","Other sources"],options2:["Scielo","Scopus","Conference","Other"],currentYear:new Date().getFullYear(),draft:!1,buttonDisable:!1,showModalProgress:!1,researchers:[],usuarios:[],errors:[],idResearcher:"",buttonText:"Send Publication"}),created(){this.getProgressReport(),this.getUsuarios(),this.getUsuarios2();const t=new Date().getFullYear(),s=2e3,l=t+1;this.years=Array.from({length:l-s+1},(n,i)=>s+i),this.selectedYear=t,this.years.sort((n,i)=>i-n)},methods:{handleFormSubmit1(t){this.nonIsiPublication.progressReport=t},getUsuarios2(){m.get("api/usuarios").then(t=>{this.usuarios=t.data.sort((s,l)=>s.name.localeCompare(l.name))}).catch(t=>console.log(t))},clearFileInput(){this.$refs.fileInput.value=""},async getFile(t){this.nonIsiPublication.file=t.target.files[0]},getUsuarios(){m.get("api/researchers").then(t=>{this.researchers=t.data}).catch(t=>console.log(t))},getProgressReport(){m.get("api/showProgressReport").then(t=>{this.nonIsiPublication.progressReport=t.data}).catch(t=>console.log(t))},async guardarBorrador(){if(await this.$refs.confirmation.show({title:"Save draft",message:"¿Are you sure you want to save this publication as a draft? this action cannot be undone.",okButton:"Save",cancelButton:"Return"})){var s="";this.nonIsiPublication.fundings!==null&&this.nonIsiPublication.fundings.length!==0&&this.nonIsiPublication.fundings.forEach((a,r)=>{s+=a.name,r===this.nonIsiPublication.fundings.length-1?s+=".":s+=", "});var l="";this.nonIsiPublication.indexedBy!==null&&this.nonIsiPublication.indexedBy.length!==0&&this.nonIsiPublication.indexedBy.forEach((a,r)=>{l+=a.name,r===this.nonIsiPublication.indexedBy.length-1?l+=".":l+=", "});var n="";this.nonIsiPublication.researcherInvolved!==null&&this.nonIsiPublication.researcherInvolved.length!==0&&this.nonIsiPublication.researcherInvolved.forEach((a,r)=>{n+=a.name,r===this.nonIsiPublication.researcherInvolved.length-1?n+=".":n+=", "});var i="";this.idResearcher!=""?i=this.idResearcher:i=this.userID;let u={status:"Draft",idUsuario:i,authors:this.nonIsiPublication.authors,indexedBy:l,researcherInvolved:n,articleTitle:this.nonIsiPublication.articleTitle,journalName:this.nonIsiPublication.journalName,volume:this.nonIsiPublication.volume,firstPage:this.nonIsiPublication.firstPage,lastPage:this.nonIsiPublication.lastPage,yearPublished:this.nonIsiPublication.yearPublished,month:this.nonIsiPublication.month,funding:s,comments:this.nonIsiPublication.comments,file:this.nonIsiPublication.file,progressReport:this.nonIsiPublication.progressReport};m.post("api/nonIsiPublications",u,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>{this.toast.success("Draft saved successfully!",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.cerrarModal()},1500)}).catch(a=>{a.response?a.response.status===422?this.toast.warning(`Validation error: ${a.response.data.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):a.response.status===404?this.toast.error("Resource not found.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):this.toast.error(`An error occurred: ${a.response.data.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):a.request?this.toast.error("No response from server.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):this.toast.error(`An error occurred: ${a.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})})}},onInput(t){const s=t.target;this.nonIsiPublication.yearPublished=s.value.slice(0,4)},cerrarModal(){const t=this.$refs.closeBtn;this.$emit("recarga"),t.click()},capitalizeFirstLetter(t){return t.charAt(0).toUpperCase()+t.slice(1)},async crearPublicacion(){this.errors=[];const t=["comments","volume","firstPage","lastPage"];for(const r in this.nonIsiPublication)!t.includes(r)&&(this.nonIsiPublication[r]===""||this.nonIsiPublication[r]===0||this.nonIsiPublication[r]==null)&&this.errors.push(r);var s=await m.post("../api/verifyNonIsi",this.nonIsiPublication).then((function(r){return r.data}).bind(this)).catch(function(r){console.log(r)});s>0&&this.errors.push("duplicated");var l="";if(this.errors.length!=0&&(this.errors.forEach(r=>{r=="articleTitle"?l=l+`The field Article Title is required
`:r=="journalName"?l=l+`The field Journal Name is required
`:r=="firstPage"?l=l+`The field First Page is required
`:r=="lastPage"?l=l+`The field Last Page is required
`:r=="yearPublished"?l=l+`The field Year Published is required
`:r=="indexedBy"?l=l+`The field Indexed By is required
`:r=="researcherInvolved"?l=l+`The field Researcher Involved is required
`:r=="duplicated"?l=l+`There is already a post with the same data, please try again.
`:l=l+"The field "+this.capitalizeFirstLetter(r)+` is required
`}),this.toast.warning(l,{position:"top-right",timeout:5e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})),this.errors.length===0&&await this.$refs.confirmation.show({title:"Send Publication",message:"¿Are you sure you want to send this publication?.",okButton:"Send",cancelButton:"Return"})){var n="";this.nonIsiPublication.fundings!==null&&this.nonIsiPublication.fundings.length!==0&&this.nonIsiPublication.fundings.forEach((p,b)=>{n+=p.name,b===this.nonIsiPublication.fundings.length-1?n+=".":n+=", "});var i="";this.nonIsiPublication.indexedBy!==null&&this.nonIsiPublication.indexedBy.length!==0&&this.nonIsiPublication.indexedBy.forEach((p,b)=>{i+=p.name,b===this.nonIsiPublication.indexedBy.length-1?i+=".":i+=", "});var u="";this.nonIsiPublication.researcherInvolved!==null&&this.nonIsiPublication.researcherInvolved.length!==0&&this.nonIsiPublication.researcherInvolved.forEach((p,b)=>{u+=p.name,b===this.nonIsiPublication.researcherInvolved.length-1?u+=".":u+=", "});var a="";this.idResearcher!=""?a=this.idResearcher:a=this.userID;let d={status:"Finished",idUsuario:a,authors:this.nonIsiPublication.authors,indexedBy:i,researcherInvolved:u,articleTitle:this.nonIsiPublication.articleTitle,journalName:this.nonIsiPublication.journalName,volume:this.nonIsiPublication.volume,firstPage:this.nonIsiPublication.firstPage,lastPage:this.nonIsiPublication.lastPage,yearPublished:this.nonIsiPublication.yearPublished,month:this.nonIsiPublication.month,funding:n,comments:this.nonIsiPublication.comments,file:this.nonIsiPublication.file,progressReport:this.nonIsiPublication.progressReport};m.post("api/nonIsiPublications",d,{headers:{"Content-Type":"multipart/form-data"}}).then(p=>{this.buttonDisable=!0,this.buttonText="Sending...",this.toast.success("Publication send successfully!",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.cerrarModal()},1500)}).catch(p=>{p.response?p.response.status===422?this.toast.warning(`Validation error: ${p.response.data.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):p.response.status===404?this.toast.error("Resource not found.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):this.toast.error(`An error occurred: ${p.response.data.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):p.request?this.toast.error("No response from server.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):this.toast.error(`An error occurred: ${p.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})})}}}},U={name:"modal"},Y={class:"modal-mask"},x={class:"modal-wrapper"},q={class:"modal-container"},J={class:"modal-header pb-1 fw-bold",style:{color:"#444444"}},G={for:""},z=e("i",{class:"fa-solid fa-pen-to-square"},null,-1),W=[z],X={key:0,class:"col-5 m-0"},K={class:"fw-normal",style:{"font-size":"14px"}},Q=e("option",{disabled:"",value:""},"Select a researcher",-1),Z=["value"],ee={class:"modal-body"},te={class:"row"},se={class:"col-md-6"},oe=e("label",{for:""},"AC3E researcher involved: ",-1),ie=e("label",{for:"",style:{color:"orange"}},"*",-1),ne=e("br",null,null,-1),le=e("br",null,null,-1),ae={class:"row"},re={class:"col-md-6"},ue=e("label",{for:""},"Author(s): ",-1),ce=e("label",{for:"",style:{color:"orange"}},"*",-1),de=e("label",{title:"The format for this field should be as follows: 'Last Name, Initial of First Name; Last Name, Initial of First Name; ...'",style:{color:"#0A95FF"}},[e("i",{class:"fa-solid fa-circle-info"})],-1),he=e("br",null,null,-1),be={class:"col-md-3"},fe=e("label",{for:""},"Year Published:",-1),pe=e("label",{for:"",style:{color:"orange"}},"*",-1),me=e("br",null,null,-1),ge=e("option",{disabled:"",value:""},"Select a year",-1),Pe=["value"],_e={class:"col-md-3"},ve=e("label",{for:"selectMonth"},"Month:",-1),Ie=e("label",{for:"selectMonth",style:{color:"orange"}},"*",-1),ye=e("br",null,null,-1),$e=e("option",{disabled:"",value:""},"Select a month",-1),we=e("option",{value:"January"},"January",-1),Be=e("option",{value:"February"},"February",-1),Oe=e("option",{value:"March"},"March",-1),ke=e("option",{value:"April"},"April",-1),Ce=e("option",{value:"May"},"May",-1),Te=e("option",{value:"June"},"June",-1),Fe=e("option",{value:"July"},"July",-1),He=e("option",{value:"August"},"August",-1),Ne=e("option",{value:"September"},"September",-1),Re=e("option",{value:"October"},"October",-1),Se=e("option",{value:"November"},"November",-1),Ve=e("option",{value:"December"},"December",-1),Le=[$e,we,Be,Oe,ke,Ce,Te,Fe,He,Ne,Re,Se,Ve],De=e("br",null,null,-1),Ae={class:"row"},Me={class:"col-md-6"},je=e("label",{for:""},"Article Title:",-1),Ee=e("label",{for:"",style:{color:"orange"}},"*",-1),Ue=e("br",null,null,-1),Ye={class:"col-md-6"},xe=e("label",{for:""},"Journal Name:",-1),qe=e("label",{for:"",style:{color:"orange"}},"*",-1),Je=e("br",null,null,-1),Ge=e("br",null,null,-1),ze={class:"row"},We={class:"col-md-4"},Xe=e("label",{for:""},"Volume:",-1),Ke=e("br",null,null,-1),Qe={class:"col-md-4"},Ze=e("label",{for:""},"First Page:",-1),et=e("br",null,null,-1),tt={class:"col-md-4"},st=e("label",{for:""},"Last Page:",-1),ot=e("br",null,null,-1),it=e("br",null,null,-1),nt={class:"row"},lt={class:"col-md-6"},at=e("label",{for:""},"Fundings: ",-1),rt=e("label",{for:"",style:{color:"orange"}},"*",-1),ut=e("br",null,null,-1),ct={class:"col-md-6"},dt=e("label",{for:""},"Comments:",-1),ht=e("br",null,null,-1),bt=e("br",null,null,-1),ft={class:"row"},pt={class:"col-md-6"},mt=e("label",{for:""},"Indexed by: ",-1),gt=e("label",{for:"",style:{color:"orange"}},"*",-1),Pt=e("br",null,null,-1),_t={class:"col-md-5"},vt={class:"form-group"},It=e("label",{for:"archivo"},"File: ",-1),yt=e("label",{for:"",style:{color:"orange"}},"*",-1),$t={class:"col-md-1 pt-2"},wt=e("br",null,null,-1),Bt=e("i",{class:"fa-solid fa-ban"},null,-1),Ot=[Bt],kt={class:"modal-footer"},Ct={class:"form-check-label"},Tt=["disabled"],Ft=["disabled"];function Ht(t,s,l,n,i,u){const a=P("Multiselect"),r=P("modalfotoperfil"),d=P("modalconfirmacion"),p=P("modalalerta"),b=P("modalProgressYear");return c(),$(A,{name:"modalcrear"},{default:L(()=>[e("div",U,[e("div",Y,[e("div",x,[e("div",q,[e("div",J,[B(t.$slots,"header",{},()=>[v(" New Publication ")]),e("label",G,[v("Progress year: "+g(t.nonIsiPublication.progressReport)+"    ",1),e("a",{class:"btn",onClick:s[0]||(s[0]=o=>t.showModalProgress=!0)},W)]),t.is("Administrator")?(c(),h("label",X,[v(" Researcher: "),e("label",K,[f(e("select",{class:"form-select","onUpdate:modelValue":s[1]||(s[1]=o=>t.idResearcher=o)},[Q,(c(!0),h(k,null,C(t.usuarios,o=>(c(),h("option",{key:o.id,value:o.id},g(o.name),9,Z))),128))],512),[[O,t.idResearcher]])])])):I("",!0),e("a",{class:"btn btn-closed",onClick:s[2]||(s[2]=o=>t.$emit("close")),ref:"closeBtn"},"X",512)]),e("div",ee,[B(t.$slots,"body",{},()=>[e("div",te,[e("div",se,[oe,ie,ne,e("div",null,[y(a,{placeholder:"Select the options",modelValue:t.nonIsiPublication.researcherInvolved,"onUpdate:modelValue":s[3]||(s[3]=o=>t.nonIsiPublication.researcherInvolved=o),searchable:!0,"close-on-select":!1,createTag:!0,options:t.researchers,mode:"tags",label:"name",trackBy:"name",object:!0},null,8,["modelValue","options"])])])]),le,e("div",ae,[e("div",re,[ue,ce,de,he,f(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[4]||(s[4]=o=>t.nonIsiPublication.authors=o)},null,512),[[_,t.nonIsiPublication.authors]])]),e("div",be,[fe,pe,me,f(e("select",{class:"form-select",id:"selectYear","onUpdate:modelValue":s[5]||(s[5]=o=>t.nonIsiPublication.yearPublished=o)},[ge,(c(!0),h(k,null,C(t.years,o=>(c(),h("option",{key:o,value:o},g(o),9,Pe))),128))],512),[[O,t.nonIsiPublication.yearPublished]])]),e("div",_e,[ve,Ie,ye,f(e("select",{class:"form-select",id:"selectMonth","onUpdate:modelValue":s[6]||(s[6]=o=>t.nonIsiPublication.month=o)},Le,512),[[O,t.nonIsiPublication.month]])])]),De,e("div",Ae,[e("div",Me,[je,Ee,Ue,f(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[7]||(s[7]=o=>t.nonIsiPublication.articleTitle=o)},null,512),[[_,t.nonIsiPublication.articleTitle]])]),e("div",Ye,[xe,qe,Je,f(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[8]||(s[8]=o=>t.nonIsiPublication.journalName=o)},null,512),[[_,t.nonIsiPublication.journalName]])])]),Ge,e("div",ze,[e("div",We,[Xe,Ke,f(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[9]||(s[9]=o=>t.nonIsiPublication.volume=o)},null,512),[[_,t.nonIsiPublication.volume]])]),e("div",Qe,[Ze,et,f(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[10]||(s[10]=o=>t.nonIsiPublication.firstPage=o)},null,512),[[_,t.nonIsiPublication.firstPage]])]),e("div",tt,[st,ot,f(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[11]||(s[11]=o=>t.nonIsiPublication.lastPage=o)},null,512),[[_,t.nonIsiPublication.lastPage]])])]),it,e("div",nt,[e("div",lt,[at,rt,ut,e("div",null,[y(a,{placeholder:"Select the options",modelValue:t.nonIsiPublication.fundings,"onUpdate:modelValue":s[12]||(s[12]=o=>t.nonIsiPublication.fundings=o),limit:"4",searchable:!0,"close-on-select":!1,createTag:!0,options:t.options1,mode:"tags",label:"name",trackBy:"name",object:!0},null,8,["modelValue","options"])])]),e("div",ct,[dt,ht,f(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[13]||(s[13]=o=>t.nonIsiPublication.comments=o)},null,512),[[_,t.nonIsiPublication.comments]])])]),bt,e("div",ft,[e("div",pt,[mt,gt,Pt,e("div",null,[y(a,{placeholder:"Select the options",modelValue:t.nonIsiPublication.indexedBy,"onUpdate:modelValue":s[14]||(s[14]=o=>t.nonIsiPublication.indexedBy=o),searchable:!0,"close-on-select":!1,createTag:!0,options:t.options2,mode:"tags",label:"name",trackBy:"name",object:!0},null,8,["modelValue","options"])])]),e("div",_t,[e("div",vt,[It,yt,e("input",{type:"file",ref:"fileInput",accept:".pdf, .jpg, .jpeg, .png,",class:"form-control",onChange:s[15]||(s[15]=(...o)=>u.getFile&&u.getFile(...o))},null,544)])]),e("div",$t,[wt,e("a",{class:"btn btn-closed",title:"Clear Input",onClick:s[16]||(s[16]=(...o)=>u.clearFileInput&&u.clearFileInput(...o))},Ot)])])])]),e("div",kt,[B(t.$slots,"footer",{},()=>[e("label",Ct,[f(e("input",{type:"checkbox",class:"form-check-","onUpdate:modelValue":s[17]||(s[17]=o=>t.draft=o)},null,512),[[D,t.draft]]),v(" Save as a draft")]),t.draft==!1?(c(),h("a",{key:0,class:"btn btn-continue float-end",onClick:s[18]||(s[18]=o=>u.crearPublicacion()),disabled:t.buttonDisable},g(t.buttonText),9,Tt)):(c(),h("a",{key:1,class:"btn btn-continue float-end",onClick:s[19]||(s[19]=o=>u.guardarBorrador()),disabled:t.buttonDisable}," Save draft ",8,Ft))])]),t.showFotoPerfil?(c(),$(r,{key:0,onClose:s[20]||(s[20]=o=>t.showFotoPerfil=!1)})):I("",!0),y(d,{ref:"confirmation"},null,512),y(p,{ref:"alert"},null,512),t.showModalProgress?(c(),$(b,{key:1,progressYear:t.nonIsiPublication.progressReport,onClose:s[21]||(s[21]=o=>t.showModalProgress=!1),onSubmit:u.handleFormSubmit1},null,8,["progressYear","onSubmit"])):I("",!0)])])])])]),_:3})}const Nt=N(E,[["render",Ht]]),Rt={components:{modalProgressYear:S,modalconfirmacion:F,modalalerta:H,Multiselect:V},mixins:[T],data:()=>({nonIsiPublication:{authors:"",articleTitle:"",indexedBy:null,journalName:"",volume:"",firstPage:"",lastPage:"",yearPublished:"",month:"",fundings:null,file:"",researcherInvolved:null,comments:"",progressReport:""},options1:["Basal Financing Program Funding","Other sources"],options2:["Scielo","Scopus","Conference","Other"],id:null,draft:!1,idResearcher:"",showModalProgress:!1,currentYear:new Date().getFullYear(),buttonDisable:!1,usuarios:[],errors:[],buttonText:"Edit Publication"}),props:{nonIsiPublication1:Object},created(){if(this.getUsuarios(),this.getUsuarios2(),this.idResearcher=this.nonIsiPublication1.idUsuario,this.id=this.nonIsiPublication1.id,this.nonIsiPublication.authors=this.nonIsiPublication1.authors,this.nonIsiPublication1.coauthor!=null&&(this.coauthor=!0,this.nonIsiPublication.coauthor=this.nonIsiPublication1.coauthor),this.nonIsiPublication.articleTitle=this.nonIsiPublication1.articleTitle,this.nonIsiPublication.journalName=this.nonIsiPublication1.journalName,this.nonIsiPublication.volume=this.nonIsiPublication1.volume,this.nonIsiPublication.firstPage=this.nonIsiPublication1.firstPage,this.nonIsiPublication.lastPage=this.nonIsiPublication1.lastPage,this.nonIsiPublication.yearPublished=this.nonIsiPublication1.yearPublished,this.nonIsiPublication.month=this.nonIsiPublication1.month,this.nonIsiPublication1.funding!=null){const n=this.nonIsiPublication1.funding.split(",");this.nonIsiPublication.fundings=n.map((i,u)=>(i=i.trim(),i.endsWith(".")&&(i=i.slice(0,-1)),{value:i,name:i}))}if(this.nonIsiPublication1.indexedBy!=null){const n=this.nonIsiPublication1.indexedBy.split(",");this.nonIsiPublication.indexedBy=n.map((i,u)=>(i=i.trim(),i.endsWith(".")&&(i=i.slice(0,-1)),{value:i,name:i}))}if(this.nonIsiPublication1.researcherInvolved!=null){const n=this.nonIsiPublication1.researcherInvolved.split(",");this.nonIsiPublication.researcherInvolved=n.map((i,u)=>(i=i.trim(),i.endsWith(".")&&(i=i.slice(0,-1)),{value:i,name:i}))}this.nonIsiPublication.file=this.nonIsiPublication1.file,this.nonIsiPublication.comments=this.nonIsiPublication1.comments,this.nonIsiPublication.progressReport=this.nonIsiPublication1.progressReport;const t=new Date().getFullYear(),s=2e3,l=t+1;this.years=Array.from({length:l-s+1},(n,i)=>s+i),this.selectedYear=t,this.years.sort((n,i)=>i-n)},methods:{handleFormSubmit1(t){this.nonIsiPublication.progressReport=t},descargarExtracto(t,s){m({url:`api/nonIsiDownload/${t}`,method:"GET",responseType:"arraybuffer"}).then(l=>{let n=new Blob([l.data],{type:l.headers["content-type"]}),i=document.createElement("a");if(i.href=window.URL.createObjectURL(n),n.type.includes("pdf"))i.download=`NonISI-${s}.pdf`;else if(n.type.includes("image"))i.download=`NonISI-${s}.png`;else{console.error("Tipo de archivo no compatible");return}i.click()})},clearFileInput(){this.$refs.fileInput.value=""},async getFile(t){this.nonIsiPublication.file=t.target.files[0]},getUsuarios2(){m.get("api/usuarios").then(t=>{this.usuarios=t.data.sort((s,l)=>s.name.localeCompare(l.name))}).catch(t=>console.log(t))},getUsuarios(){m.get("api/researchers").then(t=>{this.researchers=t.data}).catch(t=>console.log(t))},async guardarBorrador(){if(await this.$refs.confirmation.show({title:"Edit draft",message:"¿Are you sure you want to edit this publication as a draft? this action cannot be undone.",okButton:"Edit",cancelButton:"Return"})){var s="";this.nonIsiPublication.fundings!==null&&this.nonIsiPublication.fundings.length!==0&&this.nonIsiPublication.fundings.forEach((a,r)=>{s+=a.name,r===this.nonIsiPublication.fundings.length-1?s+=".":s+=", "});var l="";this.nonIsiPublication.indexedBy!==null&&this.nonIsiPublication.indexedBy.length!==0&&this.nonIsiPublication.indexedBy.forEach((a,r)=>{l+=a.name,r===this.nonIsiPublication.indexedBy.length-1?l+=".":l+=", "});var n="";this.nonIsiPublication.researcherInvolved!==null&&this.nonIsiPublication.researcherInvolved.length!==0&&this.nonIsiPublication.researcherInvolved.forEach((a,r)=>{n+=a.name,r===this.nonIsiPublication.researcherInvolved.length-1?n+=".":n+=", "});var i="";this.idResearcher!=""?i=this.idResearcher:i=this.userID;let u={idUsuario:i,status:"Draft",authors:this.nonIsiPublication.authors,indexedBy:l,researcherInvolved:n,articleTitle:this.nonIsiPublication.articleTitle,journalName:this.nonIsiPublication.journalName,volume:this.nonIsiPublication.volume,firstPage:this.nonIsiPublication.firstPage,lastPage:this.nonIsiPublication.lastPage,yearPublished:this.nonIsiPublication.yearPublished,month:this.nonIsiPublication.month,funding:s,comments:this.nonIsiPublication.comments,progressReport:this.nonIsiPublication.progressReport};await m.put(`api/nonIsiPublications/${this.id}`,u).then(a=>{this.buttonDisable=!0,this.buttonText="Sending...",this.toast.success("Draft edited successfully!",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1});const r=new FormData;r.append("id",this.id),r.append("file",this.nonIsiPublication.file),m.post("api/nonIsi/addFile",r,{headers:{"Content-Type":"multipart/form-data"}}).then(d=>{console.log(d.data),this.toast.success("File added successfully!",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.cerrarModal()},1500)}).catch(d=>{d.response.status==422&&(this.errors=d.response.data.errors,this.toast.warning("There is an invalid value.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}))})}).catch(a=>{a.response?a.response.status===422?this.toast.warning(`Validation error: ${a.response.data.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):a.response.status===404?this.toast.error("Resource not found.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):this.toast.error(`An error occurred: ${a.response.data.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):a.request?this.toast.error("No response from server.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):this.toast.error(`An error occurred: ${a.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})})}},onInput(t){const s=t.target;this.nonIsiPublication.yearPublished=s.value.slice(0,4)},cerrarModal(){const t=this.$refs.closeBtn;this.$emit("recarga"),t.click()},capitalizeFirstLetter(t){return t.charAt(0).toUpperCase()+t.slice(1)},async editarPublicacion(){this.errors=[];const t=["comments","volume","firstPage","lastPage"];for(const d in this.nonIsiPublication)!t.includes(d)&&(this.nonIsiPublication[d]===""||this.nonIsiPublication[d]===0||this.nonIsiPublication[d]==null)&&this.errors.push(d);let s={id:this.id,authors:this.nonIsiPublication.authors,indexedBy:u,researcherInvolved:a,articleTitle:this.nonIsiPublication.articleTitle,journalName:this.nonIsiPublication.journalName,volume:this.nonIsiPublication.volume,firstPage:this.nonIsiPublication.firstPage,lastPage:this.nonIsiPublication.lastPage,yearPublished:this.nonIsiPublication.yearPublished,funding:i,comments:this.nonIsiPublication.comments,file:this.nonIsiPublication.file,progressReport:this.nonIsiPublication.progressReport};var l=await m.post("../api/verifyNonIsi",s).then((function(d){return d.data}).bind(this)).catch(function(d){console.log(d)});l>0&&this.errors.push("duplicated");var n="";if(this.errors.length!=0&&(this.errors.forEach(d=>{d=="articleTitle"?n=n+`The field Article Title is required
`:d=="journalName"?n=n+`The field Journal Name is required
`:d=="firstPage"?n=n+`The field First Page is required
`:d=="lastPage"?n=n+`The field Last Page is required
`:d=="yearPublished"?n=n+`The field Year Published is required
`:d=="indexedBy"?n=n+`The field Indexed By is required
`:d=="researcherInvolved"?n=n+`The field Researcher Involved is required
`:d=="duplicated"?n=n+`There is already a post with the same data, please try again.
`:n=n+"The field "+this.capitalizeFirstLetter(d)+` is required
`}),this.toast.warning(n,{position:"top-right",timeout:5e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})),this.errors.length===0&&await this.$refs.confirmation.show({title:"Edit Publication",message:"¿Are you sure you want to edit this publication?.",okButton:"Edit",cancelButton:"Return"})){var i="";this.nonIsiPublication.fundings!==null&&this.nonIsiPublication.fundings.length!==0&&this.nonIsiPublication.fundings.forEach((b,o)=>{i+=b.name,o===this.nonIsiPublication.fundings.length-1?i+=".":i+=", "});var u="";this.nonIsiPublication.indexedBy!==null&&this.nonIsiPublication.indexedBy.length!==0&&this.nonIsiPublication.indexedBy.forEach((b,o)=>{u+=b.name,o===this.nonIsiPublication.indexedBy.length-1?u+=".":u+=", "});var a="";this.nonIsiPublication.researcherInvolved!==null&&this.nonIsiPublication.researcherInvolved.length!==0&&this.nonIsiPublication.researcherInvolved.forEach((b,o)=>{a+=b.name,o===this.nonIsiPublication.researcherInvolved.length-1?a+=".":a+=", "});var r="";this.idResearcher!=""?r=this.idResearcher:r=this.userID;let p={idUsuario:r,status:"Finished",authors:this.nonIsiPublication.authors,indexedBy:u,researcherInvolved:a,articleTitle:this.nonIsiPublication.articleTitle,journalName:this.nonIsiPublication.journalName,volume:this.nonIsiPublication.volume,firstPage:this.nonIsiPublication.firstPage,lastPage:this.nonIsiPublication.lastPage,yearPublished:this.nonIsiPublication.yearPublished,month:this.nonIsiPublication.month,funding:i,comments:this.nonIsiPublication.comments,file:this.nonIsiPublication.file,progressReport:this.nonIsiPublication.progressReport};await m.put(`api/nonIsiPublications/${this.id}`,p).then(b=>{this.buttonDisable=!0,this.buttonText="Sending...",this.toast.success("Publication edited successfully!",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1});const o=new FormData;o.append("id",this.id),o.append("file",this.nonIsiPublication.file),m.post("api/nonIsi/addFile",o,{headers:{"Content-Type":"multipart/form-data"}}).then(w=>{console.log(w.data),this.toast.success("File added successfully!",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.cerrarModal()},1500)}).catch(w=>{w.response.status==422&&(this.errors=w.response.data.errors,this.toast.warning("There is an invalid value.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}))})}).catch(b=>{b.response?b.response.status===422?this.toast.warning(`Validation error: ${b.response.data.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):b.response.status===404?this.toast.error("Resource not found.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):this.toast.error(`An error occurred: ${b.response.data.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):b.request?this.toast.error("No response from server.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}):this.toast.error(`An error occurred: ${b.message}`,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})})}}}},St={name:"modal"},Vt={class:"modal-mask"},Lt={class:"modal-wrapper"},Dt={class:"modal-container"},At={class:"modal-header pb-1 fw-bold",style:{color:"#444444"}},Mt={for:""},jt=e("i",{class:"fa-solid fa-pen-to-square"},null,-1),Et=[jt],Ut={key:0,class:"col-5 m-0"},Yt={class:"fw-normal",style:{"font-size":"14px"}},xt=e("option",{disabled:"",value:""},"Select a researcher",-1),qt=["value"],Jt={class:"modal-body"},Gt={class:"row"},zt={class:"col-md-6"},Wt=e("label",{for:""},"AC3E researcher involved: ",-1),Xt=e("label",{for:"",style:{color:"orange"}},"*",-1),Kt=e("br",null,null,-1),Qt=e("br",null,null,-1),Zt={class:"row"},es={class:"col-md-6"},ts=e("label",{for:""},"Author(s): ",-1),ss=e("label",{for:"",style:{color:"orange"}},"*",-1),os=e("label",{title:"The format for this field should be as follows: 'Last Name, Initial of First Name; Last Name, Initial of First Name; ...'",style:{color:"#0A95FF"}},[e("i",{class:"fa-solid fa-circle-info"})],-1),is=e("br",null,null,-1),ns={class:"col-md-3"},ls=e("label",{for:""},"Year Published:",-1),as=e("label",{for:"",style:{color:"orange"}},"*",-1),rs=e("br",null,null,-1),us=e("option",{disabled:"",value:null},"Select a year",-1),cs=["value"],ds={class:"col-md-3"},hs=e("label",{for:"selectMonth"},"Month:",-1),bs=e("label",{for:"selectMonth",style:{color:"orange"}},"*",-1),fs=e("br",null,null,-1),ps=e("option",{disabled:"",value:null},"Select a month",-1),ms=e("option",{value:"January"},"January",-1),gs=e("option",{value:"February"},"February",-1),Ps=e("option",{value:"March"},"March",-1),_s=e("option",{value:"April"},"April",-1),vs=e("option",{value:"May"},"May",-1),Is=e("option",{value:"June"},"June",-1),ys=e("option",{value:"July"},"July",-1),$s=e("option",{value:"August"},"August",-1),ws=e("option",{value:"September"},"September",-1),Bs=e("option",{value:"October"},"October",-1),Os=e("option",{value:"November"},"November",-1),ks=e("option",{value:"December"},"December",-1),Cs=[ps,ms,gs,Ps,_s,vs,Is,ys,$s,ws,Bs,Os,ks],Ts=e("br",null,null,-1),Fs={class:"row"},Hs={class:"col-md-6"},Ns=e("label",{for:""},"Article Title:",-1),Rs=e("label",{for:"",style:{color:"orange"}},"*",-1),Ss=e("br",null,null,-1),Vs={class:"col-md-6"},Ls=e("label",{for:""},"Journal Name:",-1),Ds=e("label",{for:"",style:{color:"orange"}},"*",-1),As=e("br",null,null,-1),Ms=e("br",null,null,-1),js={class:"row"},Es={class:"col-md-4"},Us=e("label",{for:""},"Volume:",-1),Ys=e("br",null,null,-1),xs={class:"col-md-4"},qs=e("label",{for:""},"First Page:",-1),Js=e("br",null,null,-1),Gs={class:"col-md-4"},zs=e("label",{for:""},"Last Page:",-1),Ws=e("br",null,null,-1),Xs=e("br",null,null,-1),Ks={class:"row"},Qs={class:"col-md-6"},Zs=e("label",{for:""},"Fundings: ",-1),eo=e("label",{for:"",style:{color:"orange"}},"*",-1),to=e("br",null,null,-1),so={class:"col-md-6"},oo=e("label",{for:""},"Comments:",-1),io=e("br",null,null,-1),no=e("br",null,null,-1),lo={class:"row"},ao={class:"col-md-6"},ro=e("label",{for:""},"Indexed by: ",-1),uo=e("label",{for:"",style:{color:"orange"}},"*",-1),co=e("br",null,null,-1),ho={class:"col-md-4"},bo={class:"form-group"},fo=e("label",{for:"archivo"},"File:",-1),po={key:0,title:"This record already has a file, if you want to change add a new one, otherwise leave this field empty.",style:{color:"#0A95FF"}},mo=e("i",{class:"fa-solid fa-circle-info"},null,-1),go=[mo],Po={class:"col-md-2 pt-2"},_o=e("br",null,null,-1),vo=e("i",{class:"fa-solid fa-ban"},null,-1),Io=[vo],yo=e("i",{class:"fa-solid fa-download"},null,-1),$o=[yo],wo={class:"modal-footer"},Bo={class:"form-check-label"},Oo=["disabled"],ko=["disabled"];function Co(t,s,l,n,i,u){const a=P("Multiselect"),r=P("modalfotoperfil"),d=P("modalconfirmacion"),p=P("modalalerta"),b=P("modalProgressYear");return c(),$(A,{name:"modalcrear"},{default:L(()=>[e("div",St,[e("div",Vt,[e("div",Lt,[e("div",Dt,[e("div",At,[B(t.$slots,"header",{},()=>[v(" Edit Publication ")]),e("label",Mt,[v("Progress year: "+g(t.nonIsiPublication.progressReport)+"    ",1),e("a",{class:"btn",onClick:s[0]||(s[0]=o=>t.showModalProgress=!0)},Et)]),t.is("Administrator")?(c(),h("label",Ut,[v(" Researcher: "),e("label",Yt,[f(e("select",{class:"form-select","onUpdate:modelValue":s[1]||(s[1]=o=>t.idResearcher=o)},[xt,(c(!0),h(k,null,C(t.usuarios,o=>(c(),h("option",{key:o.id,value:o.id},g(o.name),9,qt))),128))],512),[[O,t.idResearcher]])])])):I("",!0),e("a",{class:"btn btn-closed",onClick:s[2]||(s[2]=o=>t.$emit("close")),ref:"closeBtn"},"X",512)]),e("div",Jt,[B(t.$slots,"body",{},()=>[e("div",Gt,[e("div",zt,[Wt,Xt,Kt,e("div",null,[y(a,{placeholder:"Select the options",modelValue:t.nonIsiPublication.researcherInvolved,"onUpdate:modelValue":s[3]||(s[3]=o=>t.nonIsiPublication.researcherInvolved=o),searchable:!0,"close-on-select":!1,createTag:!0,options:t.researchers,mode:"tags",label:"name",trackBy:"name",object:!0},null,8,["modelValue","options"])])])]),Qt,e("div",Zt,[e("div",es,[ts,ss,os,is,f(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[4]||(s[4]=o=>t.nonIsiPublication.authors=o)},null,512),[[_,t.nonIsiPublication.authors]])]),e("div",ns,[ls,as,rs,f(e("select",{class:"form-select",id:"selectYear","onUpdate:modelValue":s[5]||(s[5]=o=>t.nonIsiPublication.yearPublished=o)},[us,(c(!0),h(k,null,C(t.years,o=>(c(),h("option",{key:o,value:o},g(o),9,cs))),128))],512),[[O,t.nonIsiPublication.yearPublished]])]),e("div",ds,[hs,bs,fs,f(e("select",{class:"form-select",id:"selectMonth","onUpdate:modelValue":s[6]||(s[6]=o=>t.nonIsiPublication.month=o)},Cs,512),[[O,t.nonIsiPublication.month]])])]),Ts,e("div",Fs,[e("div",Hs,[Ns,Rs,Ss,f(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[7]||(s[7]=o=>t.nonIsiPublication.articleTitle=o)},null,512),[[_,t.nonIsiPublication.articleTitle]])]),e("div",Vs,[Ls,Ds,As,f(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[8]||(s[8]=o=>t.nonIsiPublication.journalName=o)},null,512),[[_,t.nonIsiPublication.journalName]])])]),Ms,e("div",js,[e("div",Es,[Us,Ys,f(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[9]||(s[9]=o=>t.nonIsiPublication.volume=o)},null,512),[[_,t.nonIsiPublication.volume]])]),e("div",xs,[qs,Js,f(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[10]||(s[10]=o=>t.nonIsiPublication.firstPage=o)},null,512),[[_,t.nonIsiPublication.firstPage]])]),e("div",Gs,[zs,Ws,f(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[11]||(s[11]=o=>t.nonIsiPublication.lastPage=o)},null,512),[[_,t.nonIsiPublication.lastPage]])])]),Xs,e("div",Ks,[e("div",Qs,[Zs,eo,to,e("div",null,[y(a,{placeholder:"Select the options",modelValue:t.nonIsiPublication.fundings,"onUpdate:modelValue":s[12]||(s[12]=o=>t.nonIsiPublication.fundings=o),limit:"4",searchable:!0,"close-on-select":!1,createTag:!0,options:t.options1,mode:"tags",label:"name",trackBy:"name",object:!0},null,8,["modelValue","options"])])]),e("div",so,[oo,io,f(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[13]||(s[13]=o=>t.nonIsiPublication.comments=o)},null,512),[[_,t.nonIsiPublication.comments]])])]),no,e("div",lo,[e("div",ao,[ro,uo,co,e("div",null,[y(a,{placeholder:"Select the options",modelValue:t.nonIsiPublication.indexedBy,"onUpdate:modelValue":s[14]||(s[14]=o=>t.nonIsiPublication.indexedBy=o),limit:"4",searchable:!0,"close-on-select":!1,createTag:!0,options:t.options2,mode:"tags",label:"name",trackBy:"name",object:!0},null,8,["modelValue","options"])])]),e("div",ho,[e("div",bo,[fo,l.nonIsiPublication1.file!=null?(c(),h("label",po,go)):I("",!0),e("input",{type:"file",ref:"fileInput",accept:".pdf, .jpg, .jpeg, .png,",class:"form-control",onChange:s[15]||(s[15]=(...o)=>u.getFile&&u.getFile(...o))},null,544)])]),e("div",Po,[_o,e("a",{class:"btn btn-closed",title:"Clear Input",onClick:s[16]||(s[16]=(...o)=>u.clearFileInput&&u.clearFileInput(...o))},Io),v("   "),l.nonIsiPublication1.file!=null?(c(),h("a",{key:0,class:"btn btn-search-blue",title:"Download",onClick:s[17]||(s[17]=o=>u.descargarExtracto(t.id,l.nonIsiPublication1.usuario.name))},$o)):I("",!0)])])])]),e("div",wo,[B(t.$slots,"footer",{},()=>[e("label",Bo,[f(e("input",{type:"checkbox",class:"form-check-","onUpdate:modelValue":s[18]||(s[18]=o=>t.draft=o)},null,512),[[D,t.draft]]),v(" Edit as a draft")]),t.draft==!1?(c(),h("a",{key:0,class:"btn btn-continue float-end",onClick:s[19]||(s[19]=o=>u.editarPublicacion()),disabled:t.buttonDisable},g(t.buttonText),9,Oo)):(c(),h("a",{key:1,class:"btn btn-continue float-end",onClick:s[20]||(s[20]=o=>u.guardarBorrador()),disabled:t.buttonDisable}," Edit draft ",8,ko))])]),t.showFotoPerfil?(c(),$(r,{key:0,onClose:s[21]||(s[21]=o=>t.showFotoPerfil=!1)})):I("",!0),y(d,{ref:"confirmation"},null,512),y(p,{ref:"alert"},null,512),t.showModalProgress?(c(),$(b,{key:1,progressYear:t.nonIsiPublication.progressReport,onClose:s[22]||(s[22]=o=>t.showModalProgress=!1),onSubmit:u.handleFormSubmit1},null,8,["progressYear","onSubmit"])):I("",!0)])])])])]),_:3})}const To=N(Rt,[["render",Co]]),Fo={components:{modalver:M,modalcrear:Nt,modaleditar:To,modalconfirmacion:F,modalalerta:H},mixins:[T],data(){return{nonIsiPublications:null,showNewNonIsiPublication:!1,showEditNonIsiPublication:!1,showDetailsIsi:!1,nonIsiPublication:null,nonIsiPublicationEdit:null,mostrarTabla:!1,mostrarCarga:!0,table:null}},created(){this.getNonIsiPublications(this.userID)},methods:{descargarExtracto(t,s){m({url:`api/nonIsiDownload/${t}`,method:"GET",responseType:"arraybuffer"}).then(l=>{let n=new Blob([l.data],{type:l.headers["content-type"]}),i=document.createElement("a");if(i.href=window.URL.createObjectURL(n),n.type.includes("pdf"))i.download=`NonISI-${s}.pdf`;else if(n.type.includes("image"))i.download=`NonISI-${s}.png`;else{console.error("Tipo de archivo no compatible");return}i.click()})},verIsiPublication(t){this.nonIsiPublication=t,this.showDetailsIsi=!0},getNonIsiPublications(t){m.get(`api/nonIsiPublications/${t}`).then(s=>{this.nonIsiPublications=s.data,this.isiPublicationsAux=s.data,this.table!=null&&(this.table.clear(),this.table.destroy()),this.crearTabla("#MyTableNonIsiPublications")}).catch(s=>console.log(s))},recargarTabla(t){this.mostrarCarga=!0,t=="General"?(this.nonIsiPublications=null,this.getNonIsiPublications(this.userID)):this.crearTabla("#MyTableNonIsiPublications")},editIsiPublication(t){this.nonIsiPublicationEdit=t,this.showEditNonIsiPublication=!0},async deletePublication(t){await this.$refs.confirmation.show({title:"Delete Publication",message:"¿Are you sure you want to delete this Publication?.",okButton:"Delete",cancelButton:"Return"})&&m.delete(`api/nonIsiPublications/${t}`).then(l=>{this.toast.success("Publication successfully removed!",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),this.recargarTabla("General")}).catch(l=>console.log(l))}}},Ho={class:"row mt-4 mx-4"},No={class:"col-12"},Ro={class:"card mb-4"},So={class:"row pb-0 p-4"},Vo={class:"col-12"},Lo={class:"d-flex justify-content-end"},Do=e("i",{class:"fa-solid fa-rotate"},null,-1),Ao=[Do],Mo={class:"card-body px-0 pt-0 pb-2",style:{"min-height":"400px"}},jo={class:"container"},Eo={class:"table-responsive p-0"},Uo={class:"loader-sm"},Yo={class:"table align-items-center mb-0",id:"MyTableNonIsiPublications"},xo=e("thead",null,[e("tr",{style:{color:"black"}},[e("th",{style:{"min-width":"16px"}}),e("th",{class:"text-uppercase text-xs font-weight-bolder"},"ID"),e("th",{class:"text-uppercase text-xs font-weight-bolder"},"Actions"),e("th",{class:"text-uppercase text-xs font-weight-bolder"},"Status"),e("th",{class:"text-uppercase text-xs font-weight-bolder"},"User"),e("th",{class:"text-uppercase text-xs font-weight-bolder"},"Author(s)"),e("th",{class:"text-uppercase text-xs font-weight-bolder"},"Article Title"),e("th",{class:"text-uppercase text-xs font-weight-bolder"},"Journal Name"),e("th",{class:"text-uppercase text-xs font-weight-bolder"},"Year Published")])],-1),qo=e("td",null,null,-1),Jo={class:"text-sm font-weight-bolder mb-0",style:{color:"black"}},Go={class:"align-middle text-end"},zo={class:"d-flex px-3 py-1 justify-content-center align-items-center"},Wo=["onClick"],Xo=e("i",{class:"fa-solid fa-download"},null,-1),Ko=[Xo],Qo={key:1,class:"btn btn-grey btn-xs"},Zo=e("i",{class:"fa-solid fa-download"},null,-1),ei=[Zo],ti=["onClick"],si=e("i",{class:"fa fa-fw fa-edit"},null,-1),oi=[si],ii=["onClick"],ni=e("i",{class:"fa-regular fa-eye"},null,-1),li=[ni],ai=["onClick"],ri=e("i",{class:"fa fa-fw fa-trash"},null,-1),ui=[ri],ci={key:0,class:"text-sm font-weight-bolder mb-0",style:{color:"#878686"}},di={key:1,class:"text-sm font-weight-bolder mb-0",style:{color:"#28A745"}},hi={class:"text-sm mb-0"},bi={key:0,class:"text-sm mb-0"},fi={key:1,class:"text-sm mb-0 truncate-text"},pi={key:0,class:"text-sm mb-0"},mi={key:1,class:"text-sm mb-0 truncate-text"},gi={key:0,class:"text-sm mb-0"},Pi={key:1,class:"text-sm mb-0 truncate-text"},_i={key:0,class:"text-sm mb-0"},vi={key:1,class:"text-sm mb-0"},Ii=j('<div class="row"><div class="col-3"><label style="font-weight:500;"> These buttons use the elements selected in the table, if none exist, it will select all the records. </label></div><div class="col-auto"><label title="To select a single record from the table, just do \r Click on the box in the first column to select \r several consecutive hold SHIFT, to select several \r non-consecutive hold CTRL."><span class="badge bg-dark-grey fs-10">?</span></label></div></div>',1);function yi(t,s,l,n,i,u){const a=P("modalconfirmacion"),r=P("modalalerta"),d=P("modalver"),p=P("modaleditar"),b=P("modalcrear");return c(),h("div",Ho,[e("div",No,[e("div",Ro,[e("div",So,[e("div",Vo,[e("div",Lo,[e("a",{class:"btn btn-spacing btn-continue",id:"show-modal1",onClick:s[0]||(s[0]=o=>i.showNewNonIsiPublication=!0)},"New Publication"),v("   "),e("a",{class:"btn btn-spacing btn-search-blue",onClick:s[1]||(s[1]=o=>u.recargarTabla("General"))},Ao)])])]),e("div",Mo,[e("div",jo,[e("div",Eo,[f(e("div",Uo,null,512),[[R,i.mostrarCarga]]),f(e("table",Yo,[xo,e("tbody",null,[(c(!0),h(k,null,C(i.nonIsiPublications,o=>(c(),h("tr",{key:o.id},[qo,e("td",null,[e("p",Jo,g(o.id),1)]),e("td",Go,[e("div",zo,[o.file!=null?(c(),h("a",{key:0,class:"btn btn-search-blue btn-xs",title:"Download File",onClick:w=>u.descargarExtracto(o.id,o.usuario.name)},Ko,8,Wo)):(c(),h("a",Qo,ei)),v("   "),e("a",{class:"btn btn-alert btn-xs",title:"Edit",onClick:w=>u.editIsiPublication(o)},oi,8,ti),v("   "),e("a",{class:"btn btn-success btn-xs",title:"Details",onClick:w=>u.verIsiPublication(o)},li,8,ii),v("   "),e("a",{class:"btn btn-closed btn-xs",title:"Delete",onClick:w=>u.deletePublication(o.id)},ui,8,ai)])]),e("td",null,[o.status=="Draft"?(c(),h("p",ci,g(o.status),1)):I("",!0),o.status=="Finished"?(c(),h("p",di,g(o.status),1)):I("",!0)]),e("td",null,[e("p",hi,g(o.usuario.name),1)]),e("td",null,[o.authors==null?(c(),h("p",bi,"---")):(c(),h("p",fi,g(o.authors),1))]),e("td",null,[o.articleTitle==null?(c(),h("p",pi,"---")):(c(),h("p",mi,g(o.articleTitle),1))]),e("td",null,[o.journalName==null?(c(),h("p",gi,"---")):(c(),h("p",Pi,g(o.journalName),1))]),e("td",null,[o.yearPublished==null?(c(),h("p",_i,"---")):(c(),h("p",vi,g(o.yearPublished),1))])]))),128))])],512),[[R,i.mostrarTabla]]),Ii])])])]),y(a,{ref:"confirmation"},null,512),y(r,{ref:"alert"},null,512),i.showDetailsIsi?(c(),$(d,{key:0,nonIsiPublication1:i.nonIsiPublication,onClose:s[2]||(s[2]=o=>i.showDetailsIsi=!1)},null,8,["nonIsiPublication1"])):I("",!0),i.showEditNonIsiPublication?(c(),$(p,{key:1,nonIsiPublication1:i.nonIsiPublicationEdit,onClose:s[3]||(s[3]=o=>i.showEditNonIsiPublication=!1),onRecarga:s[4]||(s[4]=o=>u.recargarTabla("General"))},null,8,["nonIsiPublication1"])):I("",!0),i.showNewNonIsiPublication?(c(),$(b,{key:2,onClose:s[5]||(s[5]=o=>i.showNewNonIsiPublication=!1),onRecarga:s[6]||(s[6]=o=>u.recargarTabla("General"))})):I("",!0)])])}const Hi=N(Fo,[["render",yi]]);export{Hi as default};
