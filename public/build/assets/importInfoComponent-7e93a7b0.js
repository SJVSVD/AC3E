import{m as C,a as F}from"./mixins-00a35343.js";import{o as l,h as m,i as O,b as e,j as v,g as k,y as S,a as b,t as _,f as p,T as B,r as P,F as E}from"./index-a6b313c0.js";/* empty css                                                         */import{_ as w}from"./_plugin-vue_export-helper-c27b6911.js";import"./main-a60f64cc.js";const I={mixins:[C],data:()=>({excelData:[],headers:[],errorMessage:"",dataLoaded:!1}),created(){},methods:{handleFileChange(s){const t=s.target.files[0];t&&this.readFile(t)},readFile(s){const t=new FileReader;t.onload=u=>{const g=u.target.result,r=XLSX.read(g,{type:"binary"}),a=r.SheetNames[0],o=r.Sheets[a],i=XLSX.utils.sheet_to_json(o,{header:1});if(i.length>0){this.headers=i[0];const d=["idUsuario","Status","No.","Progress Report","Co-autoria centro","Author(s)","Number of Research Line","Article Title","Journal Name","Digital Object Identifier (DOI)","Volume","First page","Last page","Year Published","Sending Date","Acceptance Date","State","Funding","Main Researchers","Associative Researcher","Postdoc.","Thesis Students","International External Researchers","National External Researchers","Q","IF","Comentario"].filter(n=>!this.headers.includes(n));if(d.length>0){this.errorMessage=`The following headers are missing from the Excel file: ${d.join(", ")}`;return}this.errorMessage="",this.excelData=i.slice(1).map(n=>{const c={};return this.headers.forEach((f,h)=>{c[f]=n[h]!==void 0?n[h]:""}),c}),this.dataLoaded=!0}else this.errorMessage="El archivo Excel está vacío."},t.readAsBinaryString(s)},async processFile(){if(this.excelData.length>0)try{const s=await F.post("api/importIsi",{data:this.excelData});this.toast.success(this.excelData.length+" records have been uploaded successfully.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.$emit("close")},3e3)}catch(s){this.toast.warning("Error sending data to server:",s,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}else this.toast.warning("The excel entered is invalid.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}}},N={name:"modal"},j={class:"modal-mask"},R={class:"modal-wrapper"},X={class:"modal-container-xs"},A={class:"modal-header pb-1 fw-bold",style:{color:"#444444"}},z={class:"modal-body"},U={class:"row"},Y={class:"col-7"},K={class:"form-group"},V=e("label",{for:"archivo",style:{"font-size":"14px"}},"Select a file: ",-1),G=e("label",{for:"",style:{color:"orange"}},"*",-1),J={class:"col-5 pt-2"},W=e("br",null,null,-1),Q=["disabled"],q={key:0,style:{color:"red"}},Z={key:1},ee={style:{"font-size":"14px"}};function se(s,t,u,g,r,a){return l(),m(B,{name:"modalcrear"},{default:O(()=>[e("div",N,[e("div",j,[e("div",R,[e("div",X,[e("div",A,[v(s.$slots,"header",{},()=>[k(" Import ISI Publications ")]),e("a",{class:"btn btn-closed",onClick:t[0]||(t[0]=o=>s.$emit("close")),ref:"closeBtn"},"X",512)]),e("div",z,[v(s.$slots,"body",{},()=>[e("div",U,[e("div",Y,[e("div",K,[V,G,e("input",{type:"file",ref:"fileInput",accept:".xlsx, .xls",class:"form-control",onChange:t[1]||(t[1]=(...o)=>a.handleFileChange&&a.handleFileChange(...o))},null,544)])]),e("div",J,[W,e("a",{class:S(["btn","btn-continue",{"btn-grey":s.errorMessage}]),onClick:t[2]||(t[2]=(...o)=>a.processFile&&a.processFile(...o)),disabled:s.errorMessage},"Process File",10,Q)])]),s.errorMessage?(l(),b("p",q,_(s.errorMessage),1)):p("",!0),s.dataLoaded?(l(),b("div",Z,[e("label",ee,_(s.excelData.length)+" records have been found.",1)])):p("",!0)])])])])])])]),_:3})}const te=w(I,[["render",se]]),oe={mixins:[C],data:()=>({excelData:[],headers:[],errorMessage:"",dataLoaded:!1}),created(){},methods:{handleFileChange(s){const t=s.target.files[0];t&&this.readFile(t)},readFile(s){const t=new FileReader;t.onload=u=>{const g=u.target.result,r=XLSX.read(g,{type:"binary"}),a=r.SheetNames[0],o=r.Sheets[a],i=XLSX.utils.sheet_to_json(o,{header:1});if(i.length>0){this.headers=i[0];const d=["idUsuario","Status","Progress Report","Co-autoria centro","Author(s)","Number of Research Line","Article Title","Journal Name","Volume","First page","Last page","Year Published","Date","Indexed By Scopus Scielo, etc","State","Funding","Main Researchers","Associative Researchers","Postdoc.","Thesis Students","National External Researchers","International External Researchers","Colaboracion","Participacion nacional/internacional","Researcher Involved","Comentarios"].filter(n=>!this.headers.includes(n));if(d.length>0){this.errorMessage=`The following headers are missing from the Excel file: ${d.join(", ")}`;return}this.errorMessage="",this.excelData=i.slice(1).map(n=>{const c={};return this.headers.forEach((f,h)=>{c[f]=n[h]!==void 0?n[h]:""}),c}),this.dataLoaded=!0}else this.errorMessage="El archivo Excel está vacío."},t.readAsBinaryString(s)},async processFile(){if(this.excelData.length>0)try{const s=await F.post("api/importNonIsi",{data:this.excelData});this.toast.success(this.excelData.length+" records have been uploaded successfully.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.$emit("close")},3e3)}catch(s){this.toast.warning("Error sending data to server:",s,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}else this.toast.warning("The excel entered is invalid.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}}},re={name:"modal"},ae={class:"modal-mask"},ne={class:"modal-wrapper"},ie={class:"modal-container-xs"},le={class:"modal-header pb-1 fw-bold",style:{color:"#444444"}},de={class:"modal-body"},ce={class:"row"},he={class:"col-7"},ue={class:"form-group"},ge=e("label",{for:"archivo",style:{"font-size":"14px"}},"Select a file: ",-1),pe=e("label",{for:"",style:{color:"orange"}},"*",-1),fe={class:"col-5 pt-2"},be=e("br",null,null,-1),me=["disabled"],ve={key:0,style:{color:"red"}},_e={key:1},ye={style:{"font-size":"14px"}};function $e(s,t,u,g,r,a){return l(),m(B,{name:"modalcrear"},{default:O(()=>[e("div",re,[e("div",ae,[e("div",ne,[e("div",ie,[e("div",le,[v(s.$slots,"header",{},()=>[k(" Import Non ISI Publications ")]),e("a",{class:"btn btn-closed",onClick:t[0]||(t[0]=o=>s.$emit("close")),ref:"closeBtn"},"X",512)]),e("div",de,[v(s.$slots,"body",{},()=>[e("div",ce,[e("div",he,[e("div",ue,[ge,pe,e("input",{type:"file",ref:"fileInput",accept:".xlsx, .xls",class:"form-control",onChange:t[1]||(t[1]=(...o)=>a.handleFileChange&&a.handleFileChange(...o))},null,544)])]),e("div",fe,[be,e("a",{class:S(["btn","btn-continue",{"btn-grey":s.errorMessage}]),onClick:t[2]||(t[2]=(...o)=>a.processFile&&a.processFile(...o)),disabled:s.errorMessage},"Process File",10,me)])]),s.errorMessage?(l(),b("p",ve,_(s.errorMessage),1)):p("",!0),s.dataLoaded?(l(),b("div",_e,[e("label",ye,_(s.excelData.length)+" records have been found.",1)])):p("",!0)])])])])])])]),_:3})}const Ce=w(oe,[["render",$e]]),we={mixins:[C],data:()=>({excelData:[],headers:[],errorMessage:"",dataLoaded:!1}),created(){},methods:{handleFileChange(s){const t=s.target.files[0];t&&this.readFile(t)},readFile(s){const t=new FileReader;t.onload=u=>{const g=u.target.result,r=XLSX.read(g,{type:"binary"}),a=r.SheetNames[0],o=r.Sheets[a],i=XLSX.utils.sheet_to_json(o,{header:1});if(i.length>0){this.headers=i[0];const d=["idUsuario","Status","Work Type","Book Authors","Chapter Authors","Book Title","Chapter title","Editors","ISBN","First page","Last page","Editorial/city/country","Year","Number of Research Line","Progress Report","Comentarios","Date","State","Researcher Involved"].filter(n=>!this.headers.includes(n));if(d.length>0){this.errorMessage=`The following headers are missing from the Excel file: ${d.join(", ")}`;return}this.errorMessage="",this.excelData=i.slice(1).map(n=>{const c={};return this.headers.forEach((f,h)=>{c[f]=n[h]!==void 0?n[h]:""}),c}),this.dataLoaded=!0}else this.errorMessage="El archivo Excel está vacío."},t.readAsBinaryString(s)},async processFile(){if(this.excelData.length>0)try{const s=await F.post("api/importBook",{data:this.excelData});this.toast.success(this.excelData.length+" records have been uploaded successfully.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.$emit("close")},3e3)}catch(s){this.toast.warning("Error sending data to server:",s,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}else this.toast.warning("The excel entered is invalid.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}}},Pe={name:"modal"},Fe={class:"modal-mask"},Oe={class:"modal-wrapper"},ke={class:"modal-container-xs"},Se={class:"modal-header pb-1 fw-bold",style:{color:"#444444"}},Be={class:"modal-body"},xe={class:"row"},De={class:"col-7"},Le={class:"form-group"},He=e("label",{for:"archivo",style:{"font-size":"14px"}},"Select a file: ",-1),Me=e("label",{for:"",style:{color:"orange"}},"*",-1),Te={class:"col-5 pt-2"},Ee=e("br",null,null,-1),Ie=["disabled"],Ne={key:0,style:{color:"red"}},je={key:1},Re={style:{"font-size":"14px"}};function Xe(s,t,u,g,r,a){return l(),m(B,{name:"modalcrear"},{default:O(()=>[e("div",Pe,[e("div",Fe,[e("div",Oe,[e("div",ke,[e("div",Se,[v(s.$slots,"header",{},()=>[k(" Import Books ")]),e("a",{class:"btn btn-closed",onClick:t[0]||(t[0]=o=>s.$emit("close")),ref:"closeBtn"},"X",512)]),e("div",Be,[v(s.$slots,"body",{},()=>[e("div",xe,[e("div",De,[e("div",Le,[He,Me,e("input",{type:"file",ref:"fileInput",accept:".xlsx, .xls",class:"form-control",onChange:t[1]||(t[1]=(...o)=>a.handleFileChange&&a.handleFileChange(...o))},null,544)])]),e("div",Te,[Ee,e("a",{class:S(["btn","btn-continue",{"btn-grey":s.errorMessage}]),onClick:t[2]||(t[2]=(...o)=>a.processFile&&a.processFile(...o)),disabled:s.errorMessage},"Process File",10,Ie)])]),s.errorMessage?(l(),b("p",Ne,_(s.errorMessage),1)):p("",!0),s.dataLoaded?(l(),b("div",je,[e("label",Re,_(s.excelData.length)+" records have been found.",1)])):p("",!0)])])])])])])]),_:3})}const Ae=w(we,[["render",Xe]]),ze={mixins:[C],data:()=>({excelData:[],headers:[],errorMessage:"",dataLoaded:!1}),created(){},methods:{handleFileChange(s){const t=s.target.files[0];t&&this.readFile(t)},readFile(s){const t=new FileReader;t.onload=u=>{const g=u.target.result,r=XLSX.read(g,{type:"binary"}),a=r.SheetNames[0],o=r.Sheets[a],i=XLSX.utils.sheet_to_json(o,{header:1});if(i.length>0){this.headers=i[0];const d=["idUsuario","Status","Progress Report","Awardee(s) Name(s)","Award Name","Year","Date","Contribution of the Awardee","Awarding Institution","Country","Researcher Involved","Comentarios"].filter(n=>!this.headers.includes(n));if(d.length>0){this.errorMessage=`The following headers are missing from the Excel file: ${d.join(", ")}`;return}this.errorMessage="",this.excelData=i.slice(1).map(n=>{const c={};return this.headers.forEach((f,h)=>{c[f]=n[h]!==void 0?n[h]:""}),c}),this.dataLoaded=!0}else this.errorMessage="El archivo Excel está vacío."},t.readAsBinaryString(s)},async processFile(){if(this.excelData.length>0)try{const s=await F.post("api/importAward",{data:this.excelData});this.toast.success(this.excelData.length+" records have been uploaded successfully.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.$emit("close")},3e3)}catch(s){this.toast.warning("Error sending data to server:",s,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}else this.toast.warning("The excel entered is invalid.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}}},Ue={name:"modal"},Ye={class:"modal-mask"},Ke={class:"modal-wrapper"},Ve={class:"modal-container-xs"},Ge={class:"modal-header pb-1 fw-bold",style:{color:"#444444"}},Je={class:"modal-body"},We={class:"row"},Qe={class:"col-7"},qe={class:"form-group"},Ze=e("label",{for:"archivo",style:{"font-size":"14px"}},"Select a file: ",-1),es=e("label",{for:"",style:{color:"orange"}},"*",-1),ss={class:"col-5 pt-2"},ts=e("br",null,null,-1),os=["disabled"],rs={key:0,style:{color:"red"}},as={key:1},ns={style:{"font-size":"14px"}};function is(s,t,u,g,r,a){return l(),m(B,{name:"modalcrear"},{default:O(()=>[e("div",Ue,[e("div",Ye,[e("div",Ke,[e("div",Ve,[e("div",Ge,[v(s.$slots,"header",{},()=>[k(" Import Awards ")]),e("a",{class:"btn btn-closed",onClick:t[0]||(t[0]=o=>s.$emit("close")),ref:"closeBtn"},"X",512)]),e("div",Je,[v(s.$slots,"body",{},()=>[e("div",We,[e("div",Qe,[e("div",qe,[Ze,es,e("input",{type:"file",ref:"fileInput",accept:".xlsx, .xls",class:"form-control",onChange:t[1]||(t[1]=(...o)=>a.handleFileChange&&a.handleFileChange(...o))},null,544)])]),e("div",ss,[ts,e("a",{class:S(["btn","btn-continue",{"btn-grey":s.errorMessage}]),onClick:t[2]||(t[2]=(...o)=>a.processFile&&a.processFile(...o)),disabled:s.errorMessage},"Process File",10,os)])]),s.errorMessage?(l(),b("p",rs,_(s.errorMessage),1)):p("",!0),s.dataLoaded?(l(),b("div",as,[e("label",ns,_(s.excelData.length)+" records have been found.",1)])):p("",!0)])])])])])])]),_:3})}const ls=w(ze,[["render",is]]),ds={mixins:[C],data:()=>({excelData:[],headers:[],errorMessage:"",dataLoaded:!1}),created(){},methods:{handleFileChange(s){const t=s.target.files[0];t&&this.readFile(t)},readFile(s){const t=new FileReader;t.onload=u=>{const g=u.target.result,r=XLSX.read(g,{type:"binary"}),a=r.SheetNames[0],o=r.Sheets[a],i=XLSX.utils.sheet_to_json(o,{header:1});if(i.length>0){this.headers=i[0];const d=["idUsuario","Status","No.","Progress Report","Type of Event","Number of Research Line","Name course/congress","Number of participants","City/country","Start Date","End Date","State","Researcher Involved","Comentarios"].filter(n=>!this.headers.includes(n));if(d.length>0){this.errorMessage=`The following headers are missing from the Excel file: ${d.join(", ")}`;return}this.errorMessage="",this.excelData=i.slice(1).map(n=>{const c={};return this.headers.forEach((f,h)=>{c[f]=n[h]!==void 0?n[h]:""}),c}),this.dataLoaded=!0}else this.errorMessage="El archivo Excel está vacío."},t.readAsBinaryString(s)},async processFile(){if(this.excelData.length>0)try{const s=await F.post("api/importOrganization",{data:this.excelData});this.toast.success(this.excelData.length+" records have been uploaded successfully.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.$emit("close")},3e3)}catch(s){this.toast.warning("Error sending data to server:",s,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}else this.toast.warning("The excel entered is invalid.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}}},cs={name:"modal"},hs={class:"modal-mask"},us={class:"modal-wrapper"},gs={class:"modal-container-xs"},ps={class:"modal-header pb-1 fw-bold",style:{color:"#444444"}},fs={class:"modal-body"},bs={class:"row"},ms={class:"col-7"},vs={class:"form-group"},_s=e("label",{for:"archivo",style:{"font-size":"14px"}},"Select a file: ",-1),ys=e("label",{for:"",style:{color:"orange"}},"*",-1),$s={class:"col-5 pt-2"},Cs=e("br",null,null,-1),ws=["disabled"],Ps={key:0,style:{color:"red"}},Fs={key:1},Os={style:{"font-size":"14px"}};function ks(s,t,u,g,r,a){return l(),m(B,{name:"modalcrear"},{default:O(()=>[e("div",cs,[e("div",hs,[e("div",us,[e("div",gs,[e("div",ps,[v(s.$slots,"header",{},()=>[k(" Import Sc Organizations ")]),e("a",{class:"btn btn-closed",onClick:t[0]||(t[0]=o=>s.$emit("close")),ref:"closeBtn"},"X",512)]),e("div",fs,[v(s.$slots,"body",{},()=>[e("div",bs,[e("div",ms,[e("div",vs,[_s,ys,e("input",{type:"file",ref:"fileInput",accept:".xlsx, .xls",class:"form-control",onChange:t[1]||(t[1]=(...o)=>a.handleFileChange&&a.handleFileChange(...o))},null,544)])]),e("div",$s,[Cs,e("a",{class:S(["btn","btn-continue",{"btn-grey":s.errorMessage}]),onClick:t[2]||(t[2]=(...o)=>a.processFile&&a.processFile(...o)),disabled:s.errorMessage},"Process File",10,ws)])]),s.errorMessage?(l(),b("p",Ps,_(s.errorMessage),1)):p("",!0),s.dataLoaded?(l(),b("div",Fs,[e("label",Os,_(s.excelData.length)+" records have been found.",1)])):p("",!0)])])])])])])]),_:3})}const Ss=w(ds,[["render",ks]]),Bs={mixins:[C],data:()=>({excelData:[],headers:[],errorMessage:"",dataLoaded:!1}),created(){},methods:{handleFileChange(s){const t=s.target.files[0];t&&this.readFile(t)},readFile(s){const t=new FileReader;t.onload=u=>{const g=u.target.result,r=XLSX.read(g,{type:"binary"}),a=r.SheetNames[0],o=r.Sheets[a],i=XLSX.utils.sheet_to_json(o,{header:1});if(i.length>0){this.headers=i[0];const d=["idUsuario","Status","Progress Report","Number of Research Line","Type of Event","Name course/congress","Presentation title","Name of participants","Country","City","Start Date","End Date","Number of Participants","Type of participation","Comentarios","State","Researcher Involved"].filter(n=>!this.headers.includes(n));if(d.length>0){this.errorMessage=`The following headers are missing from the Excel file: ${d.join(", ")}`;return}this.errorMessage="",this.excelData=i.slice(1).map(n=>{const c={};return this.headers.forEach((f,h)=>{c[f]=n[h]!==void 0?n[h]:""}),c}),this.dataLoaded=!0}else this.errorMessage="El archivo Excel está vacío."},t.readAsBinaryString(s)},async processFile(){if(this.excelData.length>0)try{const s=await F.post("api/importParticipation",{data:this.excelData});this.toast.success(this.excelData.length+" records have been uploaded successfully.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.$emit("close")},3e3)}catch(s){this.toast.warning("Error sending data to server:",s,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}else this.toast.warning("The excel entered is invalid.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}}},xs={name:"modal"},Ds={class:"modal-mask"},Ls={class:"modal-wrapper"},Hs={class:"modal-container-xs"},Ms={class:"modal-header pb-1 fw-bold",style:{color:"#444444"}},Ts={class:"modal-body"},Es={class:"row"},Is={class:"col-7"},Ns={class:"form-group"},js=e("label",{for:"archivo",style:{"font-size":"14px"}},"Select a file: ",-1),Rs=e("label",{for:"",style:{color:"orange"}},"*",-1),Xs={class:"col-5 pt-2"},As=e("br",null,null,-1),zs=["disabled"],Us={key:0,style:{color:"red"}},Ys={key:1},Ks={style:{"font-size":"14px"}};function Vs(s,t,u,g,r,a){return l(),m(B,{name:"modalcrear"},{default:O(()=>[e("div",xs,[e("div",Ds,[e("div",Ls,[e("div",Hs,[e("div",Ms,[v(s.$slots,"header",{},()=>[k(" Import Sc Participations ")]),e("a",{class:"btn btn-closed",onClick:t[0]||(t[0]=o=>s.$emit("close")),ref:"closeBtn"},"X",512)]),e("div",Ts,[v(s.$slots,"body",{},()=>[e("div",Es,[e("div",Is,[e("div",Ns,[js,Rs,e("input",{type:"file",ref:"fileInput",accept:".xlsx, .xls",class:"form-control",onChange:t[1]||(t[1]=(...o)=>a.handleFileChange&&a.handleFileChange(...o))},null,544)])]),e("div",Xs,[As,e("a",{class:S(["btn","btn-continue",{"btn-grey":s.errorMessage}]),onClick:t[2]||(t[2]=(...o)=>a.processFile&&a.processFile(...o)),disabled:s.errorMessage},"Process File",10,zs)])]),s.errorMessage?(l(),b("p",Us,_(s.errorMessage),1)):p("",!0),s.dataLoaded?(l(),b("div",Ys,[e("label",Ks,_(s.excelData.length)+" records have been found.",1)])):p("",!0)])])])])])])]),_:3})}const Gs=w(Bs,[["render",Vs]]),Js={mixins:[C],data:()=>({excelData:[],headers:[],errorMessage:"",dataLoaded:!1}),created(){},methods:{handleFileChange(s){const t=s.target.files[0];t&&this.readFile(t)},readFile(s){const t=new FileReader;t.onload=u=>{const g=u.target.result,r=XLSX.read(g,{type:"binary"}),a=r.SheetNames[0],o=r.Sheets[a],i=XLSX.utils.sheet_to_json(o,{header:1});if(i.length>0){this.headers=i[0];const d=["idUsuario","Status","Progress Report","Institution with which the Center collaborates","Activity Name","Country Origin","City Origin","Beginning Date","Ending Date","Number of Research Line","Name of AC3E member","Name of external researcher involved","Collaboration stay","Comentarios","External researcher is","Country/City of destination","State","Colaboracion internacional"].filter(n=>!this.headers.includes(n));if(d.length>0){this.errorMessage=`The following headers are missing from the Excel file: ${d.join(", ")}`;return}this.errorMessage="",this.excelData=i.slice(1).map(n=>{const c={};return this.headers.forEach((f,h)=>{c[f]=n[h]!==void 0?n[h]:""}),c}),this.dataLoaded=!0}else this.errorMessage="El archivo Excel está vacío."},t.readAsBinaryString(s)},async processFile(){if(this.excelData.length>0)try{const s=await F.post("api/importCollaboration",{data:this.excelData});this.toast.success(this.excelData.length+" records have been uploaded successfully.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.$emit("close")},3e3)}catch(s){this.toast.warning("Error sending data to server:",s,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}else this.toast.warning("The excel entered is invalid.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}}},Ws={name:"modal"},Qs={class:"modal-mask"},qs={class:"modal-wrapper"},Zs={class:"modal-container-xs"},et={class:"modal-header pb-1 fw-bold",style:{color:"#444444"}},st={class:"modal-body"},tt={class:"row"},ot={class:"col-7"},rt={class:"form-group"},at=e("label",{for:"archivo",style:{"font-size":"14px"}},"Select a file: ",-1),nt=e("label",{for:"",style:{color:"orange"}},"*",-1),it={class:"col-5 pt-2"},lt=e("br",null,null,-1),dt=["disabled"],ct={key:0,style:{color:"red"}},ht={key:1},ut={style:{"font-size":"14px"}};function gt(s,t,u,g,r,a){return l(),m(B,{name:"modalcrear"},{default:O(()=>[e("div",Ws,[e("div",Qs,[e("div",qs,[e("div",Zs,[e("div",et,[v(s.$slots,"header",{},()=>[k(" Import Sc Collaborations ")]),e("a",{class:"btn btn-closed",onClick:t[0]||(t[0]=o=>s.$emit("close")),ref:"closeBtn"},"X",512)]),e("div",st,[v(s.$slots,"body",{},()=>[e("div",tt,[e("div",ot,[e("div",rt,[at,nt,e("input",{type:"file",ref:"fileInput",accept:".xlsx, .xls",class:"form-control",onChange:t[1]||(t[1]=(...o)=>a.handleFileChange&&a.handleFileChange(...o))},null,544)])]),e("div",it,[lt,e("a",{class:S(["btn","btn-continue",{"btn-grey":s.errorMessage}]),onClick:t[2]||(t[2]=(...o)=>a.processFile&&a.processFile(...o)),disabled:s.errorMessage},"Process File",10,dt)])]),s.errorMessage?(l(),b("p",ct,_(s.errorMessage),1)):p("",!0),s.dataLoaded?(l(),b("div",ht,[e("label",ut,_(s.excelData.length)+" records have been found.",1)])):p("",!0)])])])])])])]),_:3})}const pt=w(Js,[["render",gt]]),ft={mixins:[C],data:()=>({excelData:[],headers:[],errorMessage:"",dataLoaded:!1}),created(){},methods:{handleFileChange(s){const t=s.target.files[0];t&&this.readFile(t)},readFile(s){const t=new FileReader;t.onload=u=>{const g=u.target.result,r=XLSX.read(g,{type:"binary"}),a=r.SheetNames[0],o=r.Sheets[a],i=XLSX.utils.sheet_to_json(o,{header:1});if(i.length>0){this.headers=i[0];const d=["idUsuario","Status","Progress Report","Number of Research Line","Identification","Student Name","RUN or Passport","Gender (M/F)","Student Mail","Thesis Status","Thesis Title","Academic Degree","Degree Denomination","Name1","Institution1","Name2","Institution2","Name3","Institution3","University that gives the degree","Year in which student starts Program","Year in which thesis starts","Year in which thesis ends","Resources provided by the Center","Posterior working area","Institution of Posterior working area","Year of Information Report Working Area","Comentarios","Co-autoria centro"].filter(n=>!this.headers.includes(n));if(d.length>0){this.errorMessage=`The following headers are missing from the Excel file: ${d.join(", ")}`;return}this.errorMessage="",this.excelData=i.slice(1).map(n=>{const c={};return this.headers.forEach((f,h)=>{c[f]=n[h]!==void 0?n[h]:""}),c}),this.dataLoaded=!0}else this.errorMessage="El archivo Excel está vacío."},t.readAsBinaryString(s)},async processFile(){if(this.excelData.length>0)try{const s=await F.post("api/importThesis",{data:this.excelData});this.toast.success(this.excelData.length+" records have been uploaded successfully.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.$emit("close")},3e3)}catch(s){this.toast.warning("Error sending data to server:",s,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}else this.toast.warning("The excel entered is invalid.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}}},bt={name:"modal"},mt={class:"modal-mask"},vt={class:"modal-wrapper"},_t={class:"modal-container-xs"},yt={class:"modal-header pb-1 fw-bold",style:{color:"#444444"}},$t={class:"modal-body"},Ct={class:"row"},wt={class:"col-7"},Pt={class:"form-group"},Ft=e("label",{for:"archivo",style:{"font-size":"14px"}},"Select a file: ",-1),Ot=e("label",{for:"",style:{color:"orange"}},"*",-1),kt={class:"col-5 pt-2"},St=e("br",null,null,-1),Bt=["disabled"],xt={key:0,style:{color:"red"}},Dt={key:1},Lt={style:{"font-size":"14px"}};function Ht(s,t,u,g,r,a){return l(),m(B,{name:"modalcrear"},{default:O(()=>[e("div",bt,[e("div",mt,[e("div",vt,[e("div",_t,[e("div",yt,[v(s.$slots,"header",{},()=>[k(" Import Thesis Student ")]),e("a",{class:"btn btn-closed",onClick:t[0]||(t[0]=o=>s.$emit("close")),ref:"closeBtn"},"X",512)]),e("div",$t,[v(s.$slots,"body",{},()=>[e("div",Ct,[e("div",wt,[e("div",Pt,[Ft,Ot,e("input",{type:"file",ref:"fileInput",accept:".xlsx, .xls",class:"form-control",onChange:t[1]||(t[1]=(...o)=>a.handleFileChange&&a.handleFileChange(...o))},null,544)])]),e("div",kt,[St,e("a",{class:S(["btn","btn-continue",{"btn-grey":s.errorMessage}]),onClick:t[2]||(t[2]=(...o)=>a.processFile&&a.processFile(...o)),disabled:s.errorMessage},"Process File",10,Bt)])]),s.errorMessage?(l(),b("p",xt,_(s.errorMessage),1)):p("",!0),s.dataLoaded?(l(),b("div",Dt,[e("label",Lt,_(s.excelData.length)+" records have been found.",1)])):p("",!0)])])])])])])]),_:3})}const Mt=w(ft,[["render",Ht]]),Tt={mixins:[C],data:()=>({excelData:[],headers:[],errorMessage:"",dataLoaded:!1}),created(){},methods:{handleFileChange(s){const t=s.target.files[0];t&&this.readFile(t)},readFile(s){const t=new FileReader;t.onload=u=>{const g=u.target.result,r=XLSX.read(g,{type:"binary"}),a=r.SheetNames[0],o=r.Sheets[a],i=XLSX.utils.sheet_to_json(o,{header:1});if(i.length>0){this.headers=i[0];const d=["idUsuario","Status","Progress Report","Name of Postdoctoral Fellows","Identification","RUN / Passport","Gender (M/F)","Personal E-mail","Research Topic","Associated Institution","Tutor's name","Resources provided by the Center","Funding Source","Start Year","Ending Year","Number of Research Line","Posterior working area","Institution of Posterior working area","Comentarios","Starting Date (m/Y)","Ending Date (m/Y)"].filter(n=>!this.headers.includes(n));if(d.length>0){this.errorMessage=`The following headers are missing from the Excel file: ${d.join(", ")}`;return}this.errorMessage="",this.excelData=i.slice(1).map(n=>{const c={};return this.headers.forEach((f,h)=>{c[f]=n[h]!==void 0?n[h]:""}),c}),this.dataLoaded=!0}else this.errorMessage="El archivo Excel está vacío."},t.readAsBinaryString(s)},async processFile(){if(this.excelData.length>0)try{const s=await F.post("api/importPostdoc",{data:this.excelData});this.toast.success(this.excelData.length+" records have been uploaded successfully.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.$emit("close")},3e3)}catch(s){this.toast.warning("Error sending data to server:",s,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}else this.toast.warning("The excel entered is invalid.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}}},Et={name:"modal"},It={class:"modal-mask"},Nt={class:"modal-wrapper"},jt={class:"modal-container-xs"},Rt={class:"modal-header pb-1 fw-bold",style:{color:"#444444"}},Xt={class:"modal-body"},At={class:"row"},zt={class:"col-7"},Ut={class:"form-group"},Yt=e("label",{for:"archivo",style:{"font-size":"14px"}},"Select a file: ",-1),Kt=e("label",{for:"",style:{color:"orange"}},"*",-1),Vt={class:"col-5 pt-2"},Gt=e("br",null,null,-1),Jt=["disabled"],Wt={key:0,style:{color:"red"}},Qt={key:1},qt={style:{"font-size":"14px"}};function Zt(s,t,u,g,r,a){return l(),m(B,{name:"modalcrear"},{default:O(()=>[e("div",Et,[e("div",It,[e("div",Nt,[e("div",jt,[e("div",Rt,[v(s.$slots,"header",{},()=>[k(" Import Post Doc ")]),e("a",{class:"btn btn-closed",onClick:t[0]||(t[0]=o=>s.$emit("close")),ref:"closeBtn"},"X",512)]),e("div",Xt,[v(s.$slots,"body",{},()=>[e("div",At,[e("div",zt,[e("div",Ut,[Yt,Kt,e("input",{type:"file",ref:"fileInput",accept:".xlsx, .xls",class:"form-control",onChange:t[1]||(t[1]=(...o)=>a.handleFileChange&&a.handleFileChange(...o))},null,544)])]),e("div",Vt,[Gt,e("a",{class:S(["btn","btn-continue",{"btn-grey":s.errorMessage}]),onClick:t[2]||(t[2]=(...o)=>a.processFile&&a.processFile(...o)),disabled:s.errorMessage},"Process File",10,Jt)])]),s.errorMessage?(l(),b("p",Wt,_(s.errorMessage),1)):p("",!0),s.dataLoaded?(l(),b("div",Qt,[e("label",qt,_(s.excelData.length)+" records have been found.",1)])):p("",!0)])])])])])])]),_:3})}const eo=w(Tt,[["render",Zt]]),so={mixins:[C],data:()=>({excelData:[],headers:[],errorMessage:"",dataLoaded:!1}),created(){},methods:{handleFileChange(s){const t=s.target.files[0];t&&this.readFile(t)},readFile(s){const t=new FileReader;t.onload=u=>{const g=u.target.result,r=XLSX.read(g,{type:"binary"}),a=r.SheetNames[0],o=r.Sheets[a],i=XLSX.utils.sheet_to_json(o,{header:1});if(i.length>0){this.headers=i[0];const d=["idUsuario","Status","Progress Report","Type of Activity","Event Title","Activity Description","Date","Attendant Amount","Duration [days]","Country","Place Region","City","Target Audience","Research Line","Name of the main responsible","Researcher Involved","Responsibility","Comentarios","State","Participación de otras instituciones"].filter(n=>!this.headers.includes(n));if(d.length>0){this.errorMessage=`The following headers are missing from the Excel file: ${d.join(", ")}`;return}this.errorMessage="",this.excelData=i.slice(1).map(n=>{const c={};return this.headers.forEach((f,h)=>{c[f]=n[h]!==void 0?n[h]:""}),c}),this.dataLoaded=!0}else this.errorMessage="El archivo Excel está vacío."},t.readAsBinaryString(s)},async processFile(){if(this.excelData.length>0)try{const s=await F.post("api/importOutreach",{data:this.excelData});this.toast.success(this.excelData.length+" records have been uploaded successfully.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.$emit("close")},3e3)}catch(s){this.toast.warning("Error sending data to server:",s,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}else this.toast.warning("The excel entered is invalid.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}}},to={name:"modal"},oo={class:"modal-mask"},ro={class:"modal-wrapper"},ao={class:"modal-container-xs"},no={class:"modal-header pb-1 fw-bold",style:{color:"#444444"}},io={class:"modal-body"},lo={class:"row"},co={class:"col-7"},ho={class:"form-group"},uo=e("label",{for:"archivo",style:{"font-size":"14px"}},"Select a file: ",-1),go=e("label",{for:"",style:{color:"orange"}},"*",-1),po={class:"col-5 pt-2"},fo=e("br",null,null,-1),bo=["disabled"],mo={key:0,style:{color:"red"}},vo={key:1},_o={style:{"font-size":"14px"}};function yo(s,t,u,g,r,a){return l(),m(B,{name:"modalcrear"},{default:O(()=>[e("div",to,[e("div",oo,[e("div",ro,[e("div",ao,[e("div",no,[v(s.$slots,"header",{},()=>[k(" Import Outreach ")]),e("a",{class:"btn btn-closed",onClick:t[0]||(t[0]=o=>s.$emit("close")),ref:"closeBtn"},"X",512)]),e("div",io,[v(s.$slots,"body",{},()=>[e("div",lo,[e("div",co,[e("div",ho,[uo,go,e("input",{type:"file",ref:"fileInput",accept:".xlsx, .xls",class:"form-control",onChange:t[1]||(t[1]=(...o)=>a.handleFileChange&&a.handleFileChange(...o))},null,544)])]),e("div",po,[fo,e("a",{class:S(["btn","btn-continue",{"btn-grey":s.errorMessage}]),onClick:t[2]||(t[2]=(...o)=>a.processFile&&a.processFile(...o)),disabled:s.errorMessage},"Process File",10,bo)])]),s.errorMessage?(l(),b("p",mo,_(s.errorMessage),1)):p("",!0),s.dataLoaded?(l(),b("div",vo,[e("label",_o,_(s.excelData.length)+" records have been found.",1)])):p("",!0)])])])])])])]),_:3})}const $o=w(so,[["render",yo]]),Co={mixins:[C],data:()=>({excelData:[],headers:[],errorMessage:"",dataLoaded:!1}),created(){},methods:{handleFileChange(s){const t=s.target.files[0];t&&this.readFile(t)},readFile(s){const t=new FileReader;t.onload=u=>{const g=u.target.result,r=XLSX.read(g,{type:"binary"}),a=r.SheetNames[0],o=r.Sheets[a],i=XLSX.utils.sheet_to_json(o,{header:1});if(i.length>0){this.headers=i[0];const d=["idUsuario","Status","Progress Report","Name of Patent Applications","IP Type","Authors","Number of Research Line","Institution Owner(s)","Country of Registration","Application Date","Grant Date","Application Status","Registration Number","Researcher Involved","Comentarios","State"].filter(n=>!this.headers.includes(n));if(d.length>0){this.errorMessage=`The following headers are missing from the Excel file: ${d.join(", ")}`;return}this.errorMessage="",this.excelData=i.slice(1).map(n=>{const c={};return this.headers.forEach((f,h)=>{c[f]=n[h]!==void 0?n[h]:""}),c}),this.dataLoaded=!0}else this.errorMessage="El archivo Excel está vacío."},t.readAsBinaryString(s)},async processFile(){if(this.excelData.length>0)try{const s=await F.post("api/importPatent",{data:this.excelData});this.toast.success(this.excelData.length+" records have been uploaded successfully.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.$emit("close")},3e3)}catch(s){this.toast.warning("Error sending data to server:",s,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}else this.toast.warning("The excel entered is invalid.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}}},wo={name:"modal"},Po={class:"modal-mask"},Fo={class:"modal-wrapper"},Oo={class:"modal-container-xs"},ko={class:"modal-header pb-1 fw-bold",style:{color:"#444444"}},So={class:"modal-body"},Bo={class:"row"},xo={class:"col-7"},Do={class:"form-group"},Lo=e("label",{for:"archivo",style:{"font-size":"14px"}},"Select a file: ",-1),Ho=e("label",{for:"",style:{color:"orange"}},"*",-1),Mo={class:"col-5 pt-2"},To=e("br",null,null,-1),Eo=["disabled"],Io={key:0,style:{color:"red"}},No={key:1},jo={style:{"font-size":"14px"}};function Ro(s,t,u,g,r,a){return l(),m(B,{name:"modalcrear"},{default:O(()=>[e("div",wo,[e("div",Po,[e("div",Fo,[e("div",Oo,[e("div",ko,[v(s.$slots,"header",{},()=>[k(" Import Patents ")]),e("a",{class:"btn btn-closed",onClick:t[0]||(t[0]=o=>s.$emit("close")),ref:"closeBtn"},"X",512)]),e("div",So,[v(s.$slots,"body",{},()=>[e("div",Bo,[e("div",xo,[e("div",Do,[Lo,Ho,e("input",{type:"file",ref:"fileInput",accept:".xlsx, .xls",class:"form-control",onChange:t[1]||(t[1]=(...o)=>a.handleFileChange&&a.handleFileChange(...o))},null,544)])]),e("div",Mo,[To,e("a",{class:S(["btn","btn-continue",{"btn-grey":s.errorMessage}]),onClick:t[2]||(t[2]=(...o)=>a.processFile&&a.processFile(...o)),disabled:s.errorMessage},"Process File",10,Eo)])]),s.errorMessage?(l(),b("p",Io,_(s.errorMessage),1)):p("",!0),s.dataLoaded?(l(),b("div",No,[e("label",jo,_(s.excelData.length)+" records have been found.",1)])):p("",!0)])])])])])])]),_:3})}const Xo=w(Co,[["render",Ro]]),Ao={mixins:[C],data:()=>({excelData:[],headers:[],errorMessage:"",dataLoaded:!1}),created(){},methods:{handleFileChange(s){const t=s.target.files[0];t&&this.readFile(t)},readFile(s){const t=new FileReader;t.onload=u=>{const g=u.target.result,r=XLSX.read(g,{type:"binary"}),a=r.SheetNames[0],o=r.Sheets[a],i=XLSX.utils.sheet_to_json(o,{header:1});if(i.length>0){this.headers=i[0];const d=["No.","idUsuario","Progress Report","Name of Activity","Number of Research Line","Results / Goals","Agent Type","Type of Connection","State","Name of Organization","Country/City of origin","Start Date","End Date","Place(s) where activity was executed","Internacional/Nacional","Participation in definition of public policies","Researcher Involved","Comentarios"].filter(n=>!this.headers.includes(n));if(d.length>0){this.errorMessage=`The following headers are missing from the Excel file: ${d.join(", ")}`;return}this.errorMessage="",this.excelData=i.slice(1).map(n=>{const c={};return this.headers.forEach((f,h)=>{c[f]=n[h]!==void 0?n[h]:""}),c}),this.dataLoaded=!0}else this.errorMessage="El archivo Excel está vacío."},t.readAsBinaryString(s)},async processFile(){if(this.excelData.length>0)try{const s=await F.post("api/importPublicPrivate",{data:this.excelData});this.toast.success(this.excelData.length+" records have been uploaded successfully.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.$emit("close")},3e3)}catch(s){this.toast.warning("Error sending data to server:",s,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}else this.toast.warning("The excel entered is invalid.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}}},zo={name:"modal"},Uo={class:"modal-mask"},Yo={class:"modal-wrapper"},Ko={class:"modal-container-xs"},Vo={class:"modal-header pb-1 fw-bold",style:{color:"#444444"}},Go={class:"modal-body"},Jo={class:"row"},Wo={class:"col-7"},Qo={class:"form-group"},qo=e("label",{for:"archivo",style:{"font-size":"14px"}},"Select a file: ",-1),Zo=e("label",{for:"",style:{color:"orange"}},"*",-1),er={class:"col-5 pt-2"},sr=e("br",null,null,-1),tr=["disabled"],or={key:0,style:{color:"red"}},rr={key:1},ar={style:{"font-size":"14px"}};function nr(s,t,u,g,r,a){return l(),m(B,{name:"modalcrear"},{default:O(()=>[e("div",zo,[e("div",Uo,[e("div",Yo,[e("div",Ko,[e("div",Vo,[v(s.$slots,"header",{},()=>[k(" Import Public-Private ")]),e("a",{class:"btn btn-closed",onClick:t[0]||(t[0]=o=>s.$emit("close")),ref:"closeBtn"},"X",512)]),e("div",Go,[v(s.$slots,"body",{},()=>[e("div",Jo,[e("div",Wo,[e("div",Qo,[qo,Zo,e("input",{type:"file",ref:"fileInput",accept:".xlsx, .xls",class:"form-control",onChange:t[1]||(t[1]=(...o)=>a.handleFileChange&&a.handleFileChange(...o))},null,544)])]),e("div",er,[sr,e("a",{class:S(["btn","btn-continue",{"btn-grey":s.errorMessage}]),onClick:t[2]||(t[2]=(...o)=>a.processFile&&a.processFile(...o)),disabled:s.errorMessage},"Process File",10,tr)])]),s.errorMessage?(l(),b("p",or,_(s.errorMessage),1)):p("",!0),s.dataLoaded?(l(),b("div",rr,[e("label",ar,_(s.excelData.length)+" records have been found.",1)])):p("",!0)])])])])])])]),_:3})}const ir=w(Ao,[["render",nr]]),lr={mixins:[C],data:()=>({excelData:[],headers:[],errorMessage:"",dataLoaded:!1}),created(){},methods:{handleFileChange(s){const t=s.target.files[0];t&&this.readFile(t)},readFile(s){const t=new FileReader;t.onload=u=>{const g=u.target.result,r=XLSX.read(g,{type:"binary"}),a=r.SheetNames[0],o=r.Sheets[a],i=XLSX.utils.sheet_to_json(o,{header:1});if(i.length>0){this.headers=i[0];const d=["idUsuario","Status","Progress Report","Category of Transfer","Type of Transfer","Name of Beneficiary","Country","City","Place Region","Year","Number of Research Line","Description","Name of the Institions Involved","Researcher Involved","Comentarios","City/Country","Date","State"].filter(n=>!this.headers.includes(n));if(d.length>0){this.errorMessage=`The following headers are missing from the Excel file: ${d.join(", ")}`;return}this.errorMessage="",this.excelData=i.slice(1).map(n=>{const c={};return this.headers.forEach((f,h)=>{c[f]=n[h]!==void 0?n[h]:""}),c}),this.dataLoaded=!0}else this.errorMessage="El archivo Excel está vacío."},t.readAsBinaryString(s)},async processFile(){if(this.excelData.length>0)try{const s=await F.post("api/importTecAndKnow",{data:this.excelData});this.toast.success(this.excelData.length+" records have been uploaded successfully.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.$emit("close")},3e3)}catch(s){this.toast.warning("Error sending data to server:",s,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}else this.toast.warning("The excel entered is invalid.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}}},dr={name:"modal"},cr={class:"modal-mask"},hr={class:"modal-wrapper"},ur={class:"modal-container-xs"},gr={class:"modal-header pb-1 fw-bold",style:{color:"#444444"}},pr={class:"modal-body"},fr={class:"row"},br={class:"col-7"},mr={class:"form-group"},vr=e("label",{for:"archivo",style:{"font-size":"14px"}},"Select a file: ",-1),_r=e("label",{for:"",style:{color:"orange"}},"*",-1),yr={class:"col-5 pt-2"},$r=e("br",null,null,-1),Cr=["disabled"],wr={key:0,style:{color:"red"}},Pr={key:1},Fr={style:{"font-size":"14px"}};function Or(s,t,u,g,r,a){return l(),m(B,{name:"modalcrear"},{default:O(()=>[e("div",dr,[e("div",cr,[e("div",hr,[e("div",ur,[e("div",gr,[v(s.$slots,"header",{},()=>[k(" Import Tec And Know Transfer ")]),e("a",{class:"btn btn-closed",onClick:t[0]||(t[0]=o=>s.$emit("close")),ref:"closeBtn"},"X",512)]),e("div",pr,[v(s.$slots,"body",{},()=>[e("div",fr,[e("div",br,[e("div",mr,[vr,_r,e("input",{type:"file",ref:"fileInput",accept:".xlsx, .xls",class:"form-control",onChange:t[1]||(t[1]=(...o)=>a.handleFileChange&&a.handleFileChange(...o))},null,544)])]),e("div",yr,[$r,e("a",{class:S(["btn","btn-continue",{"btn-grey":s.errorMessage}]),onClick:t[2]||(t[2]=(...o)=>a.processFile&&a.processFile(...o)),disabled:s.errorMessage},"Process File",10,Cr)])]),s.errorMessage?(l(),b("p",wr,_(s.errorMessage),1)):p("",!0),s.dataLoaded?(l(),b("div",Pr,[e("label",Fr,_(s.excelData.length)+" records have been found.",1)])):p("",!0)])])])])])])]),_:3})}const kr=w(lr,[["render",Or]]),Sr={mixins:[C],data:()=>({excelData:[],headers:[],errorMessage:"",dataLoaded:!1}),created(){},methods:{handleFileChange(s){const t=s.target.files[0];t&&this.readFile(t)},readFile(s){const t=new FileReader;t.onload=u=>{const g=u.target.result,r=XLSX.read(g,{type:"binary"}),a=r.SheetNames[0],o=r.Sheets[a],i=XLSX.utils.sheet_to_json(o,{header:1});if(i.length>0){this.headers=i[0];const d=["No.","idUsuario","Progress Report","Research Line","Type Sources","Name of the Institution","Program / Contest","Project Code","Project title","Principal Researcher","Start","Finish","In Cash","In Kind","Type of collaboration","State","Comentarios"].filter(n=>!this.headers.includes(n));if(d.length>0){this.errorMessage=`The following headers are missing from the Excel file: ${d.join(", ")}`;return}this.errorMessage="",this.excelData=i.slice(1).map(n=>{const c={};return this.headers.forEach((f,h)=>{c[f]=n[h]!==void 0?n[h]:""}),c}),this.dataLoaded=!0}else this.errorMessage="El archivo Excel está vacío."},t.readAsBinaryString(s)},async processFile(){if(this.excelData.length>0)try{const s=await F.post("api/importFunding",{data:this.excelData});this.toast.success(this.excelData.length+" records have been uploaded successfully.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{this.$emit("close")},3e3)}catch(s){this.toast.warning("Error sending data to server:",s,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}else this.toast.warning("The excel entered is invalid.",{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1})}}},Br={name:"modal"},xr={class:"modal-mask"},Dr={class:"modal-wrapper"},Lr={class:"modal-container-xs"},Hr={class:"modal-header pb-1 fw-bold",style:{color:"#444444"}},Mr={class:"modal-body"},Tr={class:"row"},Er={class:"col-7"},Ir={class:"form-group"},Nr=e("label",{for:"archivo",style:{"font-size":"14px"}},"Select a file: ",-1),jr=e("label",{for:"",style:{color:"orange"}},"*",-1),Rr={class:"col-5 pt-2"},Xr=e("br",null,null,-1),Ar=["disabled"],zr={key:0,style:{color:"red"}},Ur={key:1},Yr={style:{"font-size":"14px"}};function Kr(s,t,u,g,r,a){return l(),m(B,{name:"modalcrear"},{default:O(()=>[e("div",Br,[e("div",xr,[e("div",Dr,[e("div",Lr,[e("div",Hr,[v(s.$slots,"header",{},()=>[k(" Import Funding Source ")]),e("a",{class:"btn btn-closed",onClick:t[0]||(t[0]=o=>s.$emit("close")),ref:"closeBtn"},"X",512)]),e("div",Mr,[v(s.$slots,"body",{},()=>[e("div",Tr,[e("div",Er,[e("div",Ir,[Nr,jr,e("input",{type:"file",ref:"fileInput",accept:".xlsx, .xls",class:"form-control",onChange:t[1]||(t[1]=(...o)=>a.handleFileChange&&a.handleFileChange(...o))},null,544)])]),e("div",Rr,[Xr,e("a",{class:S(["btn","btn-continue",{"btn-grey":s.errorMessage}]),onClick:t[2]||(t[2]=(...o)=>a.processFile&&a.processFile(...o)),disabled:s.errorMessage},"Process File",10,Ar)])]),s.errorMessage?(l(),b("p",zr,_(s.errorMessage),1)):p("",!0),s.dataLoaded?(l(),b("div",Ur,[e("label",Yr,_(s.excelData.length)+" records have been found.",1)])):p("",!0)])])])])])])]),_:3})}const Vr=w(Sr,[["render",Kr]]),Gr={components:{modalIsiPublication:te,modalNonIsiPublication:Ce,modalBook:Ae,modalAward:ls,modalScOrganization:Ss,modalScParticipation:Gs,modalScCollaboration:pt,modalThesisStudent:Mt,modalPostDoc:eo,modalOutreach:$o,modalPatents:Xo,modalPublicPrivate:ir,modalTecAndKnow:kr,modalFundingSource:Vr},mixins:[C],data(){return{showIsiPublication:!1,showNonIsiPublication:!1,showBooks:!1,showAwards:!1,showOrganizationSc:!1,showParticipationSc:!1,showScCollaboration:!1,showThesisStudent:!1,showPostDoc:!1,showOutreach:!1,showPatents:!1,showPublicPrivate:!1,showTecKnowTransfer:!1,showFundingSource:!1}},methods:{}},Jr={class:"container mt-4"},Wr={class:"row justify-content-center"},Qr={class:"col-lg-12"},qr={class:"card"},Zr={class:"card-body p-4",style:{"min-height":"400px"}},ea={class:"row"},sa={class:"col-3"},ta=["disabled"],oa={class:"col-3"},ra=["disabled"],aa={class:"col-3"},na=["disabled"],ia={class:"col-3"},la=["disabled"],da=e("br",null,null,-1),ca={class:"row"},ha={class:"col-3"},ua=["disabled"],ga={class:"col-3"},pa=["disabled"],fa={class:"col-3"},ba=["disabled"],ma={class:"col-3"},va=["disabled"],_a=e("br",null,null,-1),ya={class:"row"},$a={class:"col-4"},Ca=["disabled"],wa={class:"col-4"},Pa=["disabled"],Fa={class:"col-4"},Oa=["disabled"],ka=e("br",null,null,-1),Sa={class:"row"},Ba={class:"col-4"},xa=["disabled"],Da={class:"col-4"},La=["disabled"],Ha={class:"col-4"},Ma=["disabled"];function Ta(s,t,u,g,r,a){const o=P("modalIsiPublication"),i=P("modalNonIsiPublication"),$=P("modalBook"),d=P("modalAward"),n=P("modalScOrganization"),c=P("modalScParticipation"),f=P("modalScCollaboration"),h=P("modalThesisStudent"),x=P("modalPostDoc"),D=P("modalOutreach"),L=P("modalPatents"),H=P("modalPublicPrivate"),M=P("modalTecAndKnow"),T=P("modalFundingSource");return l(),b(E,null,[e("div",Jr,[e("div",Wr,[e("div",Qr,[e("div",qr,[e("div",Zr,[e("div",ea,[e("div",sa,[e("a",{class:"btn btn-search-blue",onClick:t[0]||(t[0]=y=>r.showIsiPublication=!0),disabled:s.buttonDisable,style:{"min-height":"120px",display:"flex","justify-content":"center","align-items":"center"}}," ISI Publications ",8,ta)]),e("div",oa,[e("a",{class:"btn btn-search-blue",onClick:t[1]||(t[1]=y=>r.showNonIsiPublication=!0),disabled:s.buttonDisable,style:{"min-height":"120px",display:"flex","justify-content":"center","align-items":"center"}}," Non ISI Publications ",8,ra)]),e("div",aa,[e("a",{class:"btn btn-search-blue",onClick:t[2]||(t[2]=y=>r.showBooks=!0),disabled:s.buttonDisable,style:{"min-height":"120px",display:"flex","justify-content":"center","align-items":"center"}}," Books ",8,na)]),e("div",ia,[e("a",{class:"btn btn-search-blue",onClick:t[3]||(t[3]=y=>r.showAwards=!0),disabled:s.buttonDisable,style:{"min-height":"120px",display:"flex","justify-content":"center","align-items":"center"}}," Awards ",8,la)])]),da,e("div",ca,[e("div",ha,[e("a",{class:"btn btn-search-blue",onClick:t[4]||(t[4]=y=>r.showOrganizationSc=!0),disabled:s.buttonDisable,style:{"min-height":"120px",display:"flex","justify-content":"center","align-items":"center"}}," Organization of Sc Events ",8,ua)]),e("div",ga,[e("a",{class:"btn btn-search-blue",onClick:t[5]||(t[5]=y=>r.showParticipationSc=!0),disabled:s.buttonDisable,style:{"min-height":"120px",display:"flex","justify-content":"center","align-items":"center"}}," Participation of Sc Events ",8,pa)]),e("div",fa,[e("a",{class:"btn btn-search-blue",onClick:t[6]||(t[6]=y=>r.showScCollaboration=!0),disabled:s.buttonDisable,style:{"min-height":"120px",display:"flex","justify-content":"center","align-items":"center"}}," Sc Collaboration ",8,ba)]),e("div",ma,[e("a",{class:"btn btn-search-blue",onClick:t[7]||(t[7]=y=>r.showThesisStudent=!0),disabled:s.buttonDisable,style:{"min-height":"120px",display:"flex","justify-content":"center","align-items":"center"}}," Thesis Student ",8,va)])]),_a,e("div",ya,[e("div",$a,[e("a",{class:"btn btn-search-blue",onClick:t[8]||(t[8]=y=>r.showPostDoc=!0),disabled:s.buttonDisable,style:{"min-height":"120px",display:"flex","justify-content":"center","align-items":"center"}}," PostDoc ",8,Ca)]),e("div",wa,[e("a",{class:"btn btn-search-blue",onClick:t[9]||(t[9]=y=>r.showOutreach=!0),disabled:s.buttonDisable,style:{"min-height":"120px",display:"flex","justify-content":"center","align-items":"center"}}," Outreach ",8,Pa)]),e("div",Fa,[e("a",{class:"btn btn-search-blue",onClick:t[10]||(t[10]=y=>r.showPatents=!0),disabled:s.buttonDisable,style:{"min-height":"120px",display:"flex","justify-content":"center","align-items":"center"}}," Patents ",8,Oa)])]),ka,e("div",Sa,[e("div",Ba,[e("a",{class:"btn btn-search-blue",onClick:t[11]||(t[11]=y=>r.showPublicPrivate=!0),disabled:s.buttonDisable,style:{"min-height":"120px",display:"flex","justify-content":"center","align-items":"center"}}," Public-Private Connection ",8,xa)]),e("div",Da,[e("a",{class:"btn btn-search-blue",onClick:t[12]||(t[12]=y=>r.showTecKnowTransfer=!0),disabled:s.buttonDisable,style:{"min-height":"120px",display:"flex","justify-content":"center","align-items":"center"}}," Tec and know. transfer ",8,La)]),e("div",Ha,[e("a",{class:"btn btn-search-blue",onClick:t[13]||(t[13]=y=>r.showFundingSource=!0),disabled:s.buttonDisable,style:{"min-height":"120px",display:"flex","justify-content":"center","align-items":"center"}}," Funding Source ",8,Ma)])])])])])])]),r.showIsiPublication?(l(),m(o,{key:0,onClose:t[14]||(t[14]=y=>r.showIsiPublication=!1)})):p("",!0),r.showNonIsiPublication?(l(),m(i,{key:1,onClose:t[15]||(t[15]=y=>r.showNonIsiPublication=!1)})):p("",!0),r.showBooks?(l(),m($,{key:2,onClose:t[16]||(t[16]=y=>r.showBooks=!1)})):p("",!0),r.showAwards?(l(),m(d,{key:3,onClose:t[17]||(t[17]=y=>r.showAwards=!1)})):p("",!0),r.showOrganizationSc?(l(),m(n,{key:4,onClose:t[18]||(t[18]=y=>r.showOrganizationSc=!1)})):p("",!0),r.showParticipationSc?(l(),m(c,{key:5,onClose:t[19]||(t[19]=y=>r.showParticipationSc=!1)})):p("",!0),r.showScCollaboration?(l(),m(f,{key:6,onClose:t[20]||(t[20]=y=>r.showScCollaboration=!1)})):p("",!0),r.showThesisStudent?(l(),m(h,{key:7,onClose:t[21]||(t[21]=y=>r.showThesisStudent=!1)})):p("",!0),r.showPostDoc?(l(),m(x,{key:8,onClose:t[22]||(t[22]=y=>r.showPostDoc=!1)})):p("",!0),r.showOutreach?(l(),m(D,{key:9,onClose:t[23]||(t[23]=y=>r.showOutreach=!1)})):p("",!0),r.showPatents?(l(),m(L,{key:10,onClose:t[24]||(t[24]=y=>r.showPatents=!1)})):p("",!0),r.showPublicPrivate?(l(),m(H,{key:11,onClose:t[25]||(t[25]=y=>r.showPublicPrivate=!1)})):p("",!0),r.showTecKnowTransfer?(l(),m(M,{key:12,onClose:t[26]||(t[26]=y=>r.showTecKnowTransfer=!1)})):p("",!0),r.showFundingSource?(l(),m(T,{key:13,onClose:t[27]||(t[27]=y=>r.showFundingSource=!1)})):p("",!0)],64)}const Xa=w(Gr,[["render",Ta]]);export{Xa as default};
